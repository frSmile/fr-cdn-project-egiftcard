var ObjUrl=function(n){this.id=n};ObjUrl.prototype.getUrlSubmitForm=function(){var n=$("#"+this.id);switch(this.id){case cfrmLogIn:return $("#divAccountLogIn").data("request-url");case cfrmRegister:return $("#divAccountRegister").data("request-url");case cfrmForgotPassword:return $("#divAccountForgotPassword").data("request-url");case cfrmResetPassword:return $("#divAccountRestPassword").data("request-url");case cfrmLogOff:return $("#divAccountLogOff").data("request-url");case cfrmCustomerProfileUpdate:return $("#divCustomerProfileUpdate").data("request-url");case cfrmChangePassword:return $("#divCustomerChangePassword").data("request-url");case cfrmLogOff:return $("#divAccountLogOff").data("request-url");case cfrmConfirmPayment:return $("#divConfirmPayment").data("request-url");case cfrmGuestLogin:return $("#divGuestLogin").data("request-url");case cfrmDeleteProfile:return $("#divDeleteProfile").data("request-url");case cfrmConfirmAccount:return $("#divConfirmEmail").data("request-url");case cfrmDeleteAccount:return $("#divDeleteEmail").data("request-url");default:return null}};ObjUrl.prototype.getUrlFromJson=function(){switch(this.id){case cJsonGetCustomer:return $("#divJsonGetCustomer").data("request-url");case cJsonGetCustomerAddress:return $("#divJsonGetCustomerAddress").data("request-url");case cJsonGetCart:return $("#divJsonGetCart").data("request-url");case cJsonGetOrderHistory:return $("#divJsonGetOrderHistory").data("request-url");case cJsonGetCustomerAddressBilling:return $("#divJsonGetCustomerAddressBilling").data("request-url");case cJsonClearSession:return $("#divJsonClearSession").data("request-url");case cJsonLogErrorJavaScript:return $("#divJsonLogErrorJavaScript").data("request-url");case cJsonGetDateTime:return $("#divJsonGetDateTime").data("request-url");case cJsonGetHeaderToken:return $("#divJsonGetHeaderToken").data("request-url");case cJsonGetEmergepayTransactionToken:return $("#divJsonGetEmergepayTransactionToken").data("request-url");case cJsonGetAuthenticationExpiration:return $("#divJsonGetAuthenticationExpiration").data("request-url");default:return null}};
var ObjValidateForm=function(n,t){this.id=n;this.parent=t;this.error=[];this.showAlert=!0};ObjValidateForm.prototype.verifyData=function(){var n,o,s,i,e;switch(this.id){case cfrmLogIn:n=this.parent;n.find(cfrmLogIn_Email)===undefined||n.find(cfrmLogIn_Email).val().length==0?(this.error.push(includeNewLine(cError_Email_Empty)),n.find(cfrmLogIn_Email).addClass(cCssInputValidateError)):validateEmail(n.find(cfrmLogIn_Email).val())||(this.error.push(includeNewLine(cError_Email_Validate)),n.find(cfrmLogIn_Email).addClass(cCssInputValidateError));n.find(cfrmLogIn_Password)===undefined||n.find(cfrmLogIn_Password).val().length==0?(this.error.push(includeNewLine(cError_Password_Empty)),n.find(cfrmLogIn_Password).addClass(cCssInputValidateError)):n.find(cfrmLogIn_Password).val().length<6&&(this.error.push(includeNewLine(cError_Password_Length)),n.find(cfrmLogIn_Password).addClass(cCssInputValidateError));this.error.length>0&&(multiLine(n.find(".panel-messsage-error .field-validation-error span"),this.error),n.find(".panel-messsage-error").show());break;case cfrmRegister:n=this.parent;o=!1;s=!1;n.find(cfrmRegister_Email)===undefined||n.find(cfrmRegister_Email).val().length==0?(this.error.push(includeNewLine(cError_Email_Empty)),n.find(cfrmRegister_Email).addClass(cCssInputValidateError)):validateEmail(n.find(cfrmRegister_Email).val())||(this.error.push(includeNewLine(cError_Email_Validate)),n.find(cfrmRegister_Email).addClass(cCssInputValidateError));(n.find(cfrmRegister_FirstName)===undefined||n.find(cfrmRegister_FirstName).val().length==0)&&(this.error.push(includeNewLine(cError_FirstName_Empty)),n.find(cfrmRegister_FirstName).addClass(cCssInputValidateError));(n.find(cfrmRegister_LastName)===undefined||n.find(cfrmRegister_LastName).val().length==0)&&(this.error.push(includeNewLine(cError_LastName_Empty)),n.find(cfrmRegister_LastName).addClass(cCssInputValidateError));i=n.find(cfrmRegister_PhoneNumber).val().replace("(","").replace(")","").replace(" ","").replace("-","");n.find(cfrmRegister_PhoneNumber)===undefined||n.find(cfrmRegister_PhoneNumber).val().length==0||$.isNumeric(i)==!1?(this.error.push(includeNewLine(cError_PhoneNumber_Empty)),n.find(cfrmRegister_PhoneNumber).addClass(cCssInputValidateError)):!isEmpty(i)&&i.length<10&&(this.error.push(includeNewLine(cError_PhoneNumber_Invalid)),n.find(cfrmRegister_PhoneNumber).addClass(cCssInputValidateError));this.error.length>0&&(multiLine(n.find(".panel-messsage-error .field-validation-error span"),this.error),n.find(".panel-messsage-error").show());break;case cfrmForgotPassword:break;case cfrmResetPassword:break;case cfrmLogOff:this.showAlert=!1;break;case cfrmCustomerProfileUpdate:break;case cfrmConfirmPayment:n=this.parent;vmViewIndex.cart.paymentType()!==cPaybyCredit||vmViewIndex.cart.isPayGoogle()||vmViewIndex.cart.isPayApple()||(vmViewIndex.paymentServiceProvider()==cPaymentServiceProvider_Usaepay&&(n.find(cfrmConfirmPayment_Number)===undefined||n.find(cfrmConfirmPayment_Number).val().length==0?(this.error.push(includeNewLine(cError_CreditCardNumber_Empty)),n.find(cfrmConfirmPayment_Number).addClass(cCssInputValidateError)):(n.find(cfrmConfirmPayment_Number).val().trim().replace(/\s/g,"").length<13||n.find(cfrmConfirmPayment_Number).val().trim().replace(/\s/g,"").length>16)&&(this.error.push(includeNewLine(cError_CreditCardNumber_Digits)),n.find(cfrmConfirmPayment_Number).addClass(cCssInputValidateError)),(n.find(cfrmConfirmPayment_Expiry)===undefined||n.find(cfrmConfirmPayment_Expiry).val().length==0)&&(this.error.push(includeNewLine(cError_CreditCardExpiry_Empty)),n.find(cfrmConfirmPayment_Expiry).addClass(cCssInputValidateError)),n.find(cfrmConfirmPayment_CCVC)===undefined||n.find(cfrmConfirmPayment_CCVC).val().length==0?(this.error.push(includeNewLine(cError_CreditCardCVC_Empty)),n.find(cfrmConfirmPayment_CCVC).addClass(cCssInputValidateError)):$.isNumeric(n.find(cfrmConfirmPayment_CCVC).val())||(this.error.push(includeNewLine(cError_CreditCardCVC_Invalid)),n.find(cfrmConfirmPayment_CCVC).addClass(cCssInputValidateError))),(n.find(cfrmConfirmPayment_Name)===undefined||n.find(cfrmConfirmPayment_Name).val().length==0)&&(this.error.push(includeNewLine(cError_CreditCardName_Empty)),n.find(cfrmConfirmPayment_Name).addClass(cCssInputValidateError)),(n.find(cfrmConfirmPayment_BillingAddress)===undefined||n.find(cfrmConfirmPayment_BillingAddress).val().length==0)&&(this.error.push(includeNewLine(cError_CreditCardBillingAddress_Empty)),n.find(cfrmConfirmPayment_BillingAddress).addClass(cCssInputValidateError)),n.find(cfrmConfirmPayment_BillingZip)===undefined||n.find(cfrmConfirmPayment_BillingZip).val().length==0?(this.error.push(includeNewLine(cError_CreditCardBillingZip_Empty)),n.find(cfrmConfirmPayment_BillingZip).addClass(cCssInputValidateError)):$.isNumeric(n.find(cfrmConfirmPayment_BillingZip).val())||(this.error.push(includeNewLine(cError_CreditCardBillingZip_Invalid)),n.find(cfrmConfirmPayment_BillingZip).addClass(cCssInputValidateError)),this.error.length>0?(multiLine(n.find(".panel-messsage-error .field-validation-error"),this.error),n.find(".panel-messsage-error").show()):(vmViewIndex.cart.invalidAddress(""),n.find(cfrmConfirmPayment_BillingLatitude).val().length==0||n.find(cfrmConfirmPayment_BillingLongitude).val().length==0?(vmViewIndex.cart.ccBillingAddress(n.find(cfrmConfirmPayment_BillingAddress).val()),vmViewIndex.cart.ccBillingZip(n.find(cfrmConfirmPayment_BillingZip).val())):(vmViewIndex.cart.ccBillingAddress(n.find(cfrmConfirmPayment_BillingAddress).val()),vmViewIndex.cart.ccBillingZip(n.find(cfrmConfirmPayment_BillingZip).val()),vmViewIndex.cart.billingAddressLatitude(n.find(cfrmConfirmPayment_BillingLatitude).val()),vmViewIndex.cart.billingAddressLongitude(n.find(cfrmConfirmPayment_BillingLongitude).val()),vmViewIndex.cart.billingAddressCity(n.find(cfrmConfirmPayment_BillingCity).val()),vmViewIndex.cart.billingAddressState(n.find(cfrmConfirmPayment_BillingState).val()))));break;case cfrmGuestLogin:n=checkMobileForResolution()||checkMiddleMobileForResolution()?$("#checkout-user #frmGuestLogin"):$("#modalCaptchaGuest #frmGuestLogin");var r=n.find(cfrmGuestFirstName),u=n.find(cfrmGuestLastName),f=n.find(cfrmGuestEmail),t=n.find(cfrmGuestPhone);(r===undefined||r.val().length==0)&&(this.error.push(includeNewLine(cError_GuestFirstName_Empty)),r.addClass(cCssInputValidateError));(u===undefined||u.val().length==0)&&(this.error.push(includeNewLine(cError_GuestLastName_Empty)),u.addClass(cCssInputValidateError));(f===undefined||f.val().length==0)&&(this.error.push(includeNewLine(cError_GuestEmail_Empty)),f.addClass(cCssInputValidateError));(t===undefined||t.val().length==0)&&(this.error.push(includeNewLine(cError_GuestPhone_Empty)),t.addClass(cCssInputValidateError));e=n.find(t).val().replace("(","").replace(")","").replace(" ","").replace("-","");e.length!=10&&e!=""&&(this.error.push(includeNewLine(cError_GuestPhone_Invalid_Format)),t.addClass(cCssInputValidateError));break;default:return null}};
var ObjAlert=function(n,t,i){this.id=n;this.errMsg=t;this.status=i};ObjAlert.prototype.getAlert=function(){var t="",n="";if(this.status)t=cSwal_Icon_Success,n=cSwal_Alert_Success;else{t=cSwal_Icon_Error;switch(this.id){case cfrmLogIn:n=cSwal_Alert_InvalidLogIn;break;default:n=cSwal_Alert_Error}}switch(this.id){case cfrmLogIn:swal(n,this.errMsg,t);break;case cfrmRegister:swal(n,this.errMsg,t);break;default:swal(n,this.errMsg,t)}};
function clearAllStore(){store.clearAll()}function clearStore(n){store.remove(n)}function getStore(n){return store.get(n)}function setStore(n,t){store.set(n,t)}function addItemStore(n,t){var i=[],r,u;i.push(getItemStore(n,t));setStore(getStoreId(cStoreCart,n),i);r=getStore(cStoreDateTime);isEmpty(r)&&setStore(cStoreDateTime,_currentTime);u=getStore(cStoreLastedUpdateTime);isEmpty(u)&&setStore(cStoreLastedUpdateTime,vmViewIndex.globalConfig.shopLastUpdate())}function deleteItemStore(n){store.remove(getStoreId(cStoreCart,n))}function updateItemStore(n,t){var i=getStore(getStoreId(cStoreCart,n));store.transact(cStoreCart+n,function(i){_.forEach(i,function(i){if(i.cartId==n){var r=getItem(n,t);i.giftCerImagesName=r.giftCerImagesName;i.giftCerImagesId=r.giftCerImagesId;i.giftCerValueId=r.giftCerValueId;i.getAmount=r.getAmount;i.payAmount=r.payAmount;i.selectCustomId=r.selectCustomId;i.customAmount=r.customAmount;i.customPayAmount=r.customPayAmount;i.isCustomDiscount=r.isCustomDiscount;i.selectCheckBoxSendType=r.selectCheckBoxSendType;i.email=r.email;i.phone=r.phone;i.from=r.from;i.message=r.message;i.selectDate=r.selectDate;i.todayAsap=r.todayAsap}})})}function getItem(n,t){var i=[];return ko.utils.arrayForEach(t.selectCheckBoxSendType(),function(n){var t={giftCerSendTypeId:n.giftCerSendTypeId(),giftCerSendTypeName:n.giftCerSendTypeName()};i.push(t)}),{cartId:n,qty:1,giftCerImagesName:t.giftCerImagesName(),giftCerImagesId:t.giftCerImagesId(),giftCerValueId:t.giftCerValueId(),getAmount:t.getAmount(),payAmount:t.payAmount(),selectCustomId:t.selectCustomId(),customAmount:t.customAmount(),customPayAmount:t.customPayAmount(),isCustomDiscount:t.isCustomDiscount(),selectCheckBoxSendType:JSON.stringify(i),email:t.email(),phone:t.phone(),from:t.from(),message:t.message(),selectDate:t.selectDate(),todayAsap:t.todayAsap()}}function getItemStore(n,t){var i=[];return ko.utils.arrayForEach(t.giftCerDetail.selectCheckBoxSendType(),function(n){var t={giftCerSendTypeId:n.giftCerSendTypeId(),giftCerSendTypeName:n.giftCerSendTypeName()};i.push(t)}),{cartId:n,qty:1,giftCerImagesName:t.giftCerImages.selectGiftCerImageName(),giftCerImagesId:t.giftCerImages.selectGiftCerImageId(),giftCerValueId:t.giftCerAmount.selectGiftCerValueId(),getAmount:t.giftCerAmount.selectGetAmount(),payAmount:t.giftCerAmount.selectPayAmount(),selectCustomId:t.giftCerAmount.selectCustomId(),customAmount:t.giftCerAmount.customAmount(),customPayAmount:t.giftCerAmount.customPayAmount(),isCustomDiscount:t.giftCerAmount.isCustomDiscount(),selectCheckBoxSendType:JSON.stringify(i),email:t.giftCerDetail.email(),phone:t.giftCerDetail.phone(),from:t.giftCerDetail.from(),message:t.giftCerDetail.message(),selectDate:t.giftCerDetail.isAsap()?moment(_currentTime.toDate()).format(moment_date_format_yyyymmddthhmmss):moment(t.giftCerDetail.selectDate()).format(moment_date_format_yyyymmddthhmmss),todayAsap:t.giftCerDetail.isAsap()?!0:!1}}function changeQtyStore(n,t,i){var r=getStore(getStoreId(cStoreCart,n));store.transact(cStoreCart+n,function(r){_.forEach(r,function(r){r.cartId==n&&(r.qty=t,r.totalPriceWithOutTax=i)})})}function getStoreId(n,t){return n+t}function getCountCart(){var t=store.keys(),n=0;return _.forEach(t,function(t){if(_.includes(t,cStoreCart)){var i=Number(t.match(/\d+/));n<i&&(n=i)}}),n+1}function clearStoreAfterSuccess(){store(!1)}function refreshStore(){var r=_currentTime.clone(),u=moment(r,moment_date_format_yyyymmddthhmmss),n=store(cStoreDateTime),t=store(cStoreLastedUpdateTime),i;isEmpty(n)||(n=moment(n,moment_date_format_yyyymmddthhmmss),i=u.diff(n,"days"),i>3&&store(!1));isEmpty(t)||t!=vmViewIndex.globalConfig.shopLastUpdate()&&store(!1);store.each(function(n,t){if(_.includes(n,cStoreCart)){var i=t[0],r=ko.mapping.fromJS(i),u=Number(n.match(/\d+/));vmViewIndex.cart.data.push(new DataCartViewModel(u,r,!0));vmViewIndex.cart.calculateCart()}})}
var _currentTime="",vmViewIndex,timeoutHandle,timeoutHandleConfirmPayment,_timeoutHandleSessionExpired,cMobileMenuHome="Home",cMobileMenuLogIn="Log In",cMobileMenuRegister="Register",cMobileMenuProfile="Profile",cMobileMenuChangePassword="Change Password",cMobileMenuHistory="History",cMobileMenuLogOff="Log Out",cfrmLogIn="frmLogIn",cfrmLogIn_Email="#txtLogInEmail",cfrmLogIn_Password="#txtLogInPassword",cPaybyCredit="CREDIT",cfrmRegister="frmRegister",cfrmRegister_Email="#txtRegisterEmail",cfrmRegister_FirstName="#txtRegisterFirstName",cfrmRegister_LastName="#txtRegisterLastName",cfrmRegister_PhoneNumber="#txtRegisterPhoneNumber",cfrmRegister_Password="#txtRegisterPassword",cfrmRegister_ConfirmPassword="#txtRegisterConfirmPassword",cfrmGuestLogin="frmGuestLogin",cfrmGuestFirstName="#txtGuestFirstName",cfrmGuestLastName="#txtGuestLastName",cfrmGuestEmail="#txtGuestEmail",cfrmGuestPhone="#txtGuestPhone",cError_Email_Empty='- Field "Email" should not be empty.',cError_Email_Validate="- Must be a valid Email Address.",cError_FirstName_Empty='- Field "First Name" should not be empty.',cError_LastName_Empty='- Field "Last Name" should not be empty.',cError_PhoneNumber_Empty='- Field "Phone Number" should not be empty.',cError_PhoneNumber_Invalid='- Invalid "Phone Number" ',cError_Password_Empty='-Field "Password" should not be empty.',cError_Password_Length="- The Field Password must be at least 6 characters.",cError_ConfirmPassword_Empty='- Field "Confirm Password"should not be empty.',cError_ConfirmPassword_Length="- The Field Confirm Password must be at least 6 characters.",cError_Password_NotMatch="- The password and confirmation password do not match.",cError_Fail_TimeOut="Invalid form data was sent to server. Please refresh this form and try again.",cError_Fail_NoInternet="Can't connect to the Internet. Please refresh your browser.",cError_Delivery_Method="Please choose delivery method.",cError_CustomerAddress_Phone_Empty='- Field "Phone" should not be empty.',cError_CustomerAddress_Phone_Formatted="- Phone number formatted incorrectly.",cError_CustomerAddress_From='- Field "From" should not be empty.',cError_Message='- Field "Message" should not be empty.',cError_Fail_NoInternet="Can't connect to the Internet. Please refresh your browser.",cError_Fail_TimeOut="Invalid form data was sent to server. Please refresh this form and try again.",cError_Zero="please enter a number greater than zero",cError_Dev_Url="Please set url in layout page",cError_GiftCard_Images="- Please choose image.",cError_GiftCard_Amount="- Please choose or fill amount.",cError_GiftCard_Delivery="- Please choose delivery.",cError_GiftCard_Email="- Please fill email.",cError_GiftCard_Email_Not_Correct="- Email not Correct.",cError_GiftCard_Phone="- Please fill phone number.",cError_GiftCard_From="- please fill from.",cError_GiftCard_Message="- please fill message.",cError_GiftCard_CanNotAddCart="Can not add cart.\nPlease, try again.",cError_CreditCardNumber_Empty='- "Credit Card Number" can\'t be blank.',cError_CreditCardName_Empty='- "Credit Card Name" can\'t be blank.',cError_CreditCardExpiry_Empty='- "Expiry" can\'t be blank.',cError_CreditCardCVC_Empty='- "CVC" can\'t be blank.',cError_CreditCardBillingZip_Empty='- "Billing zip" can\'t be blank.',cError_CreditCardBillingAddress_Empty='- "Billing address" can\'t be blank.',cError_CreditCardCVC_Invalid="Invalid CVC",cError_CreditCardBillingZip_Invalid="Invalid Billing zip",cError_addressNumber_NotFound="Sorry, your address number is not found. Please input address number",cError_GuestFirstName_Empty='- "First Name" can\'t be blank.',cError_GuestLastName_Empty='- "Last Name" can\'t be blank.',cError_GuestEmail_Empty='- "Email" should can\'t be blank.',cError_GuestPhone_Empty='- "Phone" should can\'t be blank.',cError_GuestPhone_Invalid_Format='- "Phone" must be 10 characters for telephone number [ex. (XXX) XXX-XXXX]',cSwal_Icon_Success="success",cSwal_Alert_Success="Success...",cSwal_Icon_Error="error",cSwal_Icon_Info="info",cSwal_Icon_Warning="warning",cSwal_Alert_Error="Error...",cSwal_Alert_Required="Forget Something?",cSwal_Alert_InvalidLogIn="Invalid Login.",cCssInputValidateError="input-validation-error",cJsonGetCustomer="jsonGetCustomer",cJsonGetCustomerAddress="jsonGetCustomerAddress",cJsonGetCart="jsonGetCart",cJsonGetOrderHistory="jsonGetOrderHistory",cJsonGetCustomerAddressBilling="jsonGetCustomerAddressBilling",cJsonClearSession="jsonClearSession",cJsonLogErrorJavaScript="jsonLogErrorJavaScript",cJsonGetDateTime="jsonGetDateTime",cJsonGetHeaderToken="jsonGetHeaderToken",cJsonGetEmergepayTransactionToken="jsonGetEmergepayTransactionToken",cJsonGetAuthenticationExpiration="jsonGetAuthenticationExpiration",cfrmResetPassword="frmResetPassword",cfrmResetPassword_Password="#txtResetPasswordCurrentPassword",cfrmResetPassword_ConfirmPassword="#txtResetPasswordConfirmPassword",cfrmChangePassword="frmChangePassword",cfrmChangePassword_Password="#txtChangePasswordOldPassword",cfrmChangePassword_NewPassword="#txtChangePasswordNewPassword",cfrmChangePassword_ConfirmNewPassword="#txtChangePasswordConfirmPassword",cfrmForgotPassword="frmForgotPassword",cfrmForgotPassword_Email="#txtForgotPassswordEmail",cfrmDeleteProfile="frmDeleteProfile",cfrmConfirmAccount="frmConfirmAccount",cfrmDeleteAccount="frmDeleteAccount",cfrmCustomerProfileUpdate="frmCustomerProfileUpdate",cfrmCustomerProfileUpdate_FirstName="#txtUpdateCustomerProfileFirstName",cfrmCustomerProfileUpdate_LastName="#txtUpdateCustomerProfileLastName",cfrmCustomerProfileUpdate_PhoneNumber="#txtUpdateCustomerProfilePhoneNumber",cfrmConfirmPayment="frmConfirmPayment",cfrmConfirmPayment_Number="#txtCCNumber",cfrmConfirmPayment_Name="#txtCCName",cfrmConfirmPayment_Expiry="#txtCCExpiry",cfrmConfirmPayment_CCVC="#txtCCCVC",cfrmConfirmPayment_BillingZip="#txtBillingZip",cfrmConfirmPayment_BillingAddress="#txtBillingAddress",cfrmConfirmPayment_BillingCity="#hdBillingAddressCity",cfrmConfirmPayment_BillingSubCity="#hdBillingAddressSubCity",cfrmConfirmPayment_BillingState="#hdBillingAddressState",cfrmConfirmPayment_BillingLatitude="#hdBillingAddressLatitude",cfrmConfirmPayment_BillingLongitude="#hdBillingAddressLongitude",cfrmConfirmPayment_SuggestionAddress="#modalConfirmPaymentSuggestionAddress",cfrmConfirmPayment_SuggestionAddressContent="#modalConfirmPaymentSuggestionAddressContent",cfrmConfirmPayment_Emergepay_CardNumberContainer="emergepay_cardNumberContainer",cfrmConfirmPayment_Emergepay_ExpirationDateContainer="emergepay_expirationDateContainer",cfrmConfirmPayment_Emergepay_SecurityCodeContainer="emergepay_securityCodeContainer",cfrmConfirmPayment_Emergepay_CardNumberError="emergepay_card_number_error",cfrmConfirmPayment_Emergepay_ExpirationDateError="emergepay_card_expiration_date_error",cfrmConfirmPayment_Emergepay_SecurityCodeError="emergepay_card_security_code_error",cfrmConfirmPayment_Emergepay_PayBtn="emergepay_payBtn",cfrmConfirmPayment_Emergepay_HostedIframe="emergepay_hostedIframe",cfrmConfirmPayment_Emergepay_ValidationError="emergepay_validationError",cfrmDiscount="frmDiscount",cfrmLogOff="frmLogOff",cProtocal="https",cStoreCart="smilewebgiftcard-cart",cStoreDateTime="smilewebgiftcard-dateTime",cStoreLastedUpdateTime="smilewebgiftcard-lastupdatetime",cDefaultAmount="50.00",cTextMessage="Text Message",cEmail="Email",cAll="All",cCustomAmount="Custom",cDefaultBarCode=$("#divDefaultBarCode").data("img-src"),cPathFileBase="",cGiftCerPath="GIFTCER",cMobile="MOBILE",cPaymentServiceProvider_Usaepay=1,cPaymentServiceProvider_Emergepay=2,cEmergepay_TransactionType_CreditSale="CreditSale";
function setUpGooglePay(){$("#btnGooglePay").hide();window.PaymentRequest&&(isChrome()||isEdageChromium())&&isSafari()==!1&&$("#btnGooglePay").show()}function getDisplayItems(){let n=[];return obj={},obj.label="Subtotal",obj.amount={},obj.amount.currency="USD",obj.amount.value=vmViewIndex.cart.subTotal(),n.push(obj),obj={},obj.label="Discount",obj.amount={},obj.amount.currency="USD",obj.amount.value="-"+vmViewIndex.cart.discount(),n.push(obj),JSON.parse(JSON.stringify(n))}function initPaymentRequest(){var n=vmViewIndex.cart.summaryTotal().toFixed(2);let t={total:{label:"Total",amount:{currency:"USD",value:n}},displayItems:getDisplayItems()};return new PaymentRequest([{supportedMethods:"basic-card",data:{supportedNetworks:["amex","diners","discover","jcb","mastercard","unionpay","visa","mir"],supportedTypes:["debit","credit"]}}],t,{requestPayerName:!1,requestPayerPhone:!1,requestPayerEmail:!1,requestShipping:!1})}function sendPaymentToServer(n){const t=n.details,r=t.cardNumber,u=t.cardholderName,f=t.expiryMonth,e=t.expiryYear,o=f+"/"+e,s=t.cardSecurityCode,i=t.billingAddress,h=i.addressLine[0],c=i.city,l=i.postalCode,a=h+" "+c;vmViewIndex.cart.ccNumber(r);vmViewIndex.cart.ccName(u);vmViewIndex.cart.ccExpiry(o);vmViewIndex.cart.ccCVC(s);vmViewIndex.cart.ccBillingAddress(a);vmViewIndex.cart.ccBillingZip(l);ConfirmPayment(cfrmConfirmPayment,n)}function instrumentToJsonString(n){let t=n.details;return t.cardNumber="XXXX-XXXX-XXXX-"+t.cardNumber.substr(12),t.cardSecurityCode="***",JSON.stringify({methodName:n.methodName,details:t},undefined,2)}var ChromeSamples={log:function(){var n=Array.prototype.slice.call(arguments).map(function(n){return typeof n=="string"?n:JSON.stringify(n)}).join(" ");document.querySelector("#log").textContent+=n+"\n"},clearLog:function(){document.querySelector("#log").textContent=""},setStatus:function(){requestAbort()},setContent:function(n){for(var t=document.querySelector("#content");t.hasChildNodes();)t.removeChild(t.lastChild);t.appendChild(n)}};$("#btnGooglePay").click(function(){var t=initPaymentRequest(),r;if(t.canMakePayment()){vmViewIndex.cart.isPayGoogle(!0);var i=$(getIdTag(cfrmConfirmPayment)),u=i.attr("id"),f=i.parent(),n=new ObjValidateForm(u,f);if(n.verifyData(),n.error.length>0)return n.showAlert&&(r=convertArrToString(n.error),swal(cSwal_Alert_Error,replaceNewLineToBr(r),cSwal_Icon_Error)),!0;if(vmViewIndex.cart.invalidAddress().length>0)return suggestionAddress(vmViewIndex.cart.invalidAddress(),cfrmConfirmPayment_SuggestionAddress),!0;if(vmViewIndex.globalConfig.captchaEnable()&&!vmViewIndex.checkout.verifyCaptcha())return swal("Oops...","Please check the box below to processed",cSwal_Icon_Info),$(".g-recaptcha").children(":first").css("border","1px solid red"),!0;t.show().then(function(n){sendPaymentToServer(n)}).catch(function(n){ChromeSamples.setStatus(n)})}});
function filterGlobalConfig(n,t){var i=ko.utils.arrayFilter(n,function(n){return t==n.globalConfigKey});return i.length===0?null:i[0].globalConfigValue}function setMaskPhone(){$(".mask-phone").inputmask({mask:"(999) 999-9999"})}function setMaskPhone2(){$(".mask-phone").mask("(999) 999-9999")}function setBlockEmoji(){function n(n){return n.replace(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff]|[\u2764]|[\uFE0F]|[\uffff])/g,"")}$("input").bind("input",function(){var t=$(this).val(),i=n(t);$(this).val(i)});$("input").bind("paste",function(){var t=$(this).val(),i=n(t);$(this).val(i)});$("textarea").bind("input",function(){var t=$(this).val(),i=n(t);$(this).val(i)});$("textarea").bind("paste",function(){var t=$(this).val(),i=n(t);$(this).val(i)})}function toShowAmount(n){return"$"+n}function isTouchDevice(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}function giftCardDetail(){function t(){n.classList.add("show-back");n.classList.remove("show-front")}function u(){n.classList.remove("show-back");n.classList.add("show-front")}var i=document.getElementById("buy"),r=document.getElementById("checkout"),n=document.querySelector(".giftcard");i.addEventListener("click",function(){t()});r.addEventListener("click",function(){var i=vmViewIndex,r=$(".front").find("img").eq(0),t=$("#checkout"),n;t.attr("disabled",!0);n=$(".mobile-cart-anchor");n.eq(0).offset().left<=0&&(n=$(".desktop-cart-anchor"));flyToElement(r,t,n,function(){vmViewIndex.cart.clickSubmitGiftCer(i,event);const n=$(".main"),r=$(".cardDetail");if(n.off("animationend"),n.removeClass("animated bounceOut"),r.removeClass("animated bounceIn"),r.addClass("animated bounceOut"),window.matchMedia("(prefers-reduced-motion)"))r.hide(),n.show(),n.addClass("animated bounceIn");else r.on("animationend",function(){r.hide();n.show();n.addClass("animated bounceIn")});u();$(".descriptionPreview .amount").slick("slickGoTo",0);t.attr("disabled",!1)})})}function FlyToCart(n){var u,t,i;const r=verifyDataBeforeAddToCart();isEmpty(r)?(u=$(".preview").find("img").eq(0),t=$(n),t.attr("disabled",!0),i=$(".desktop-cart-anchor"),i.eq(0).offset().left<=0&&(i=$(".mobile-cart-anchor")),flyToElement(u,t,i,function(){vmViewIndex.cart.clickSubmitGiftCer(vmViewIndex,event);t.attr("disabled",!1)})):showMsgErrorVerifyAddToCart(r)}function verifyDataBeforeAddToCart(){var n=vmViewIndex,i=!0,t=[];const r=$(".inputRecipient .email"),u=$(".inputRecipient .phone"),f=$(".checkboxDelivery i");return n.giftCerDetail.selectCheckBoxSendType().length==0?(f.addClass("no-after"),f.addClass(cCssInputValidateError),t.push(includeNewLine(cError_Delivery_Method)),i=!1):n.giftCerDetail.selectCheckBoxSendType().length>0&&ko.utils.arrayForEach(n.giftCerDetail.selectCheckBoxSendType(),function(f){var e,o;f.giftCerSendTypeName()==cEmail&&(n.giftCerDetail.email().length==0?(t.push(includeNewLine(cError_Email_Empty)),r.addClass(cCssInputValidateError),i=!1):(e=n.giftCerDetail.email(),validateEmail(e)||(t.push(includeNewLine(cError_Email_Validate)),r.addClass(cCssInputValidateError),i=!1)));f.giftCerSendTypeName()==cTextMessage&&(n.giftCerDetail.phone().length==0?(t.push(includeNewLine(cError_CustomerAddress_Phone_Empty)),u.addClass(cCssInputValidateError),i=!1):(o=n.giftCerDetail.phone().toString().replace(/\D/g,""),o.length<10&&(t.push(includeNewLine(cError_CustomerAddress_Phone_Formatted)),u.addClass(cCssInputValidateError),i=!1)))}),isEmpty(n.giftCerImages.selectGiftCerImageId())&&(t.push(includeNewLine(cError_GiftCard_Images)),i=!1),n.giftCerDetail.from().length==0&&(t.push(includeNewLine(cError_CustomerAddress_From)),$(".inputPurchaser input").addClass(cCssInputValidateError),i=!1),n.giftCerDetail.message().length==0&&(t.push(includeNewLine(cError_Message)),$(".inputMessage textarea").addClass(cCssInputValidateError),i=!1),n.giftCerAmount.selectGetAmount()==0&&n.giftCerAmount.selectPayAmount()==0&&n.giftCerAmount.isCustomDiscount()&&(t.push(includeNewLine(cError_Zero)),i=!1,$(".descriptionPreview input.descCustomAmount").addClass(cCssInputValidateError)),t}function showMsgErrorVerifyAddToCart(n){var t=convertArrToString(n);swal(cSwal_Alert_Error,replaceNewLineToBr(t),cSwal_Icon_Error).then(function(){isChrome()?$(".inputPurchaser").attr("tabindex",-1).focus():$(".labelCount").attr("tabindex",-1).focus()})}function validationCheckBox(n){const t=$(".checkboxDelivery i"),i="no-after";n?(t.removeClass(i),t.removeClass(cCssInputValidateError)):(t.addClass(i),t.addClass(cCssInputValidateError))}function flyToElement(n,t,i,r){var l=$(this),o=Math.round($(t).offset().top),s=Math.round($(t).offset().left),h=Math.round($(i).eq(0).offset().top),c=Math.round($(i).eq(0).offset().left),u=$(n).clone(),f,e;$(u).css({position:"absolute",top:o+"px",left:s+"px",width:"50px",height:"50px",opacity:1,"z-index":1e4,"border-radius":"50%"});$("body").append($(u));f=c-50;e=h-20;$(u).animate({opacity:.5,left:f,top:e,width:100,height:100},700,function(){$(i).fadeOut("fast",function(){$(i).fadeIn("fast",function(){$(u).fadeOut("fast",function(){typeof r=="function"&&($(u).remove(),r.call(this,!0))})})})})}function countdown(n,t){function u(){var t=document.getElementById("timer"),n;setCookieCountDown("minutes",r,10);setCookieCountDown("seconds",i,10);n=r-1;i--;t.innerHTML=n.toString()+":"+(i<10?"0":"")+String(i);i>0?timeoutHandle=setTimeout(u,1e3):r>1?setTimeout(function(){countdown(parseInt(r)-1,!1)},1e3):r==1&&i==0&&redirectMain()}var i=60,r=n;getCookieCountDown("minutes")&&getCookieCountDown("seconds")&&t&&(i=getCookieCountDown("seconds"),r=getCookieCountDown("minutes"));u()}function setCookieCountDown(n,t,i){var r=new Date,u;r.setTime(r.getTime()+i*864e5);u="expires="+r.toGMTString();document.cookie=n+"="+t+"; "+u}function getCookieCountDown(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}function countdownSwalConfirmPayment(n){function r(){var n=document.getElementById("timerConfirmPayment"),u=i-1;t--;n.innerHTML=u.toString()+":"+(t<10?"0":"")+String(t);t>0?timeoutHandleConfirmPayment=setTimeout(r,1e3):i>1?setTimeout(function(){countdownSwalConfirmPayment(parseInt(i)-1,!1)},1e3):i==1&&t==0&&$(".cancelConfirmPayment").click()}var t=60,i=n;r()}function setScrollTop(){$(window).scrollTop(0)}function setGeoLocation(){$("#"+cfrmConfirmPayment+" "+cfrmConfirmPayment_BillingAddress).geocomplete({details:".googleAddress",detailsAttribute:"data-geo",country:"US"})}function onKeyBillingAddressChange(n){var t=n.keyCode?n.keyCode:n.which;t=="13"&&vmViewIndex.cart.isAddressChange(!0)}function onBillingAddressChange(){vmViewIndex.cart.isAddressChange()||(document.getElementById(cfrmConfirmPayment_BillingLatitude.replace("#","")).value="",document.getElementById(cfrmConfirmPayment_BillingLongitude.replace("#","")).value="");vmViewIndex.cart.isAddressChange(!1)}function suggestionAddress(n){var t="",i=function(n,i){if(i==google.maps.places.PlacesServiceStatus.OK)n.forEach(function(n){t+='<div class="bs-callout bs-suggestion"><div class="row"><div class="col-sm-12 suggestionAddress" id="'+n.place_id+'">'+n.description+"<\/div><\/div><\/div>"}),$(cfrmConfirmPayment_SuggestionAddressContent).html(t),$(cfrmConfirmPayment_SuggestionAddress).modal("show");else{$(cfrmConfirmPayment_BillingAddress).addClass(cCssInputValidateError);var r=new ObjAlert(null,cError_CustomerAddress_Fail,!1);r.getAlert()}return!0},r=new google.maps.places.AutocompleteService;r.getPlacePredictions({input:n,componentRestrictions:{country:"us"}},i)}function getGeoData(n,t){var i=new google.maps.Geocoder;i.geocode({placeId:n},function(n,i){if(i!=="OK")typeof t=="function"&&t.call(this,"");else{var u={},f=_.head(n),r=f.geometry,e=r.viewport,o=r.bounds,s=f.address_components,h=f.formatted_address;_.forEach(s,function(n){var t=_.head(n.types);_.forEach(n.types,function(t){u[t]=n.long_name;u[t+"_short"]=n.short_name})});_.assignIn(u,{formatted_address:h,location_type:r.location_type||"PLACES",viewport:e,bounds:o,location:r.location,lat:r.location.lat(),lng:r.location.lng()});typeof t=="function"&&t.call(this,u)}})}function disableErrMsg(n){n.parent().parent().parent().parent().find(".panel-messsage-error").hide();n.removeClass(cCssInputValidateError)}function disableErrMsgConfirmPayment(n){n.parent().parent().parent().parent().parent().parent().find(".panel-messsage-error").hide();n.removeClass(cCssInputValidateError)}function countTextMessage(n){const t=150-n;return t>0&&t<150?t+" Character":""}function swalConfirmPayment(n){var t="";vmViewIndex.paymentServiceProvider()==cPaymentServiceProvider_Emergepay&&vmViewIndex.cart.paymentType()==cPaybyCredit&&(t=`<div class="text-center" style="font-size: 0.95rem; font-weight: 400; color: #5956BE; margin: 8px 0 30px 0;">
                "Please confirm within <span id="timerConfirmPayment"></span>"
            </div>`);swal({html:`<div style="font-size: 24px; font-weight: 500; word-break: break-word; margin: 0 7%;">Are you sure you want to check out?</div>
            ${t}
            `,type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirm!",cancelButtonText:"Cancel",confirmButtonClass:"btn theme default-button",cancelButtonClass:"btn btn-danger cancelConfirmPayment",buttonsStyling:!1,showLoaderOnConfirm:!0,allowEscapeKey:!1,preConfirm:function(){ConfirmPayment(n,null)},allowOutsideClick:!1}).then({},function(n){n==="cancel"&&(window.clearTimeout(timeoutHandleConfirmPayment),checkSetUpEmergepayCheckout())})}function ConfirmPayment(n,t){window.clearTimeout(timeoutHandle);window.clearTimeout(timeoutHandleConfirmPayment);var i=new ObjUrl(n),r=i.getUrlSubmitForm(),u=$(getIdTag(n)).serialize();return new Promise(function(){$.ajax({url:r,"async":ajax_async,cache:ajax_cache,type:ajax_type_post,data:u,timeout:ajax_timeout,headers:{RequestVerificationToken:token()}}).done(function(i){var r,u;try{if(vmViewIndex.globalConfig.captchaKeepAlive()==!1&&(r=getObjFormAjax(cJsonClearSession,""),isEmpty(r)||($("#divVarHeader").val(r),window.clearTimeout(_timeoutHandleSessionExpired))),vmViewIndex.globalConfig.captchaEnable()==!0&&resetCaptCha(),isEmpty(t)||t.complete("success"),i.status){switch(n){case cfrmConfirmPayment:store(!1);window.clearTimeout(_timeoutHandleSessionExpired);vmViewIndex.checkout.step(4);vmViewIndex.cart.data.removeAll();$("#checkout-payment").removeClass("active");$('a[href="#checkout-payment"]').removeClass("active");$("#checkout-complete").addClass("active");$('a[href="#checkout-complete"]').addClass("active");completeConfirm(i)}isLoading(!1)}else isLoading(!1),countdown(15,!0),u=new ObjAlert(n,i.message,i.status),u.getAlert(),vmViewIndex.globalConfig.captchaEnable()&&resetCaptCha(),i.obj!="NoRefresh"?($("#checkout-payment").css({opacity:.5}),$("#checkout-payment input").prop("disabled",!0),$("#checkout-payment button").prop("disabled",!0),$("#checkout-payment .paymentType").hide(),redirectMain()):checkSetUpEmergepayCheckout()}catch(f){logErrorJavaScript(f,"function.js/cfrmConfirmPayment",657,!0)}}).fail(function(){if(isLoading(!1),vmViewIndex.globalConfig.captchaKeepAlive()==!1){var n=getObjFormAjax(cJsonClearSession,"");isEmpty(n)||$("#divVarHeader").val(n)}vmViewIndex.globalConfig.captchaEnable()&&resetCaptCha();swal("Oops...",cError_Fail_TimeOut,cSwal_Icon_Error);$("#checkout-payment").css({opacity:.5});$("#checkout-payment input").prop("disabled",!0);$("#checkout-payment button").prop("disabled",!0);$("#checkout-payment .paymentType").hide();redirectMain()})})}function swalConfirmDeleteProfile(){swal({title:'<label style="width: 90%">Are you sure you want to delete your account?<\/label>',text:"Your contact information, order history and payment information within your account will be deleted. You will be unable to log into this account again. This information will not be recoverable. This cannot be undone.",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirm!",cancelButtonText:"Cancel",confirmButtonClass:"btn theme default-button",cancelButtonClass:"btn btn-danger",buttonsStyling:!1,showLoaderOnConfirm:!0,allowEscapeKey:!1,preConfirm:function(){var n=new ObjUrl(cfrmDeleteProfile),t=n.getUrlSubmitForm(),i={customerId:vmViewIndex.customer.customerId()};return new Promise(function(){$.ajax({url:t,"async":ajax_async,cache:ajax_cache,type:ajax_type_post,data:i,timeout:ajax_timeout,headers:{RequestVerificationToken:token()}}).done(function(n){if(n.status)vmViewIndex.globalConfig.captchaEnable()&&resetCaptCha(),redirectMain();else{var t=new ObjAlert(formId,n.message,n.status);t.getAlert()}}).fail(function(){if(vmViewIndex.globalConfig.captchaKeepAlive()==!1){var n=getObjFormAjax(cJsonClearSession,"");isEmpty(n)||$("#divVarHeader").val(n)}vmViewIndex.globalConfig.captchaEnable()&&resetCaptCha();swal("Oops...",cError_Fail_TimeOut,cSwal_Icon_Error);$("#checkout-payment").css({opacity:.5});$("#checkout-payment input").prop("disabled",!0);$("#checkout-payment button").prop("disabled",!0);$("#checkout-payment .paymentType").hide();redirectMain()})})},allowOutsideClick:!1})}function completeConfirm(n){setInvisible(getClassTag("open-navigation"));swal("Confirm Success!",n.message,cSwal_Icon_Success);setScrollTop()}function redirectMain(){var n=$("#divHomeViewIndex").data("request-url");location.href=n}function callBackAccountConfirm(n,t){var i=t?cfrmConfirmAccount:cfrmDeleteAccount,r=new ObjUrl(i),u=r.getUrlSubmitForm(),f={rt:n};$.ajax({url:u,"async":ajax_async,cache:ajax_cache,type:ajax_type_post,data:f,timeout:ajax_timeout,headers:{RequestVerificationToken:token()}}).done(function(n){vmViewIndex.loading.loadingVisible(!1);var t=new ObjAlert(i,n.message,n.status);t.getAlert()}).fail(function(){vmViewIndex.loading.loadingVisible(!1);swal(cSwal_Alert_Error,cError_Fail_Order,cSwal_Icon_Error)})}function isDevice(){const t="none",n="display";var i=$(".display .mobile").css(n),r=$(".display .phablet").css(n),u=$(".display .tablet").css(n),f=$(".display .desktop").css(n);return i!=t?"mobile":r!=t?"phablet":u!=t?"tablet":"desktop"}function resetCaptCha(){try{var n=$("#turnstileWidget iframe").attr("id"),t=$("#turnstileWidgetLogin iframe").attr("id");turnstile.reset(n);turnstile.reset(t)}catch(i){}vmViewIndex.checkout.verifyCaptcha(!1);vmViewIndex.checkout.verifyCaptchaLogin(!1)}function eventModal(){$("#modalForgotPassword").on("show.bs.modal",function(){$("#modalCaptchaLogin").modal("hide");$("#modalCaptchaRegister").modal("hide")});$("#modalCaptchaLogin").on("show.bs.modal",function(){vmViewIndex.mobile.showAccountSelect(!1)})}function getObjFormAjax(n,t){var r=new ObjUrl(n),u=r.getUrlFromJson(),i;return isEmpty(t)||(i=JSON.parse('{"key" : "'+t+'"}')),getJsonFromAjaxAddHeader(u,!ajax_async,ajax_cache,ajax_type_post,i,ajax_timeout,token())}function isLoading(n){n?vmViewIndex.loading.loadingVisible(!0):vmViewIndex.loading.loadingVisible(!1)}function checkApplePay(){isEmpty(checkVersionIE())&&isSafari()&&(isEmpty(vmViewIndex.apiKey())?isEmpty(vmViewIndex.apiKeyEmergepay())||setUpApplePayEmergepay():setUpApplePay())}function setInputCustomAmountNumeric(){$(".descCustomAmount").on("textInput",function(n){var t=n.originalEvent.data.charCodeAt(0);return String.fromCharCode(t).match(/^\d*[.]?\d*$/)?!0:!1})}function checkDisableCheckboxDelivery(){function n(n){var t=n[0].id,i=t.indexOf("_"),r=t.substring(i+1);return n.is(":checked")?null:(n.prop("checked",!0),r)}$(".descriptionPreview .checkboxDelivery input:checkbox").on("click",function(){var i=$(this),t;vmViewIndex.giftCerDetail.selectCheckBoxSendType().length<1&&(t=n(i),isEmpty(t)||vmViewIndex.giftCerDetail.selectCheckBoxSendType.push(vmViewIndex.giftCerDetail.dataSendType()[t]))});$("#modalCartUpdate .checkboxDelivery input:checkbox").on("click",function(){var i=$(this),t;vmViewIndex.cart.currentCheckBoxSendType().length<1&&(t=n(i),isEmpty(t)||vmViewIndex.cart.currentCheckBoxSendType.push(vmViewIndex.cart.currentDataSendType()[t]))})}function getJsonFromAjaxAddHeader(n,t,i,r,u,f,e){var o,s=$.ajax({url:n,"async":t,cache:i,type:r,data:u,timeout:f,headers:{RequestVerificationToken:e}});return s.done(function(n){o=n.obj}),s.fail(function(){o=null}),o}function token(){var n=$("#divVarHeader").val(),t=CryptoJS.AES.decrypt("U2FsdGVkX19jacDAZPtd03Eub4KwNqSVUnArZavh8wa0L8Z38ZhAxtsGIv9MHJtX",""),i=t.toString(CryptoJS.enc.Utf8),r=CryptoJS.AES.decrypt(n,i);return r.toString(CryptoJS.enc.Utf8)}function logErrorJavaScript(n,t,i,r){var u=new ObjUrl(cJsonLogErrorJavaScript),f=u.getUrlFromJson(),e={msg:n,url:t,line:i.toString(),isNormal:r};$.ajax({url:f,"async":ajax_async,cache:ajax_cache,type:ajax_type_post,data:e,timeout:ajax_timeout,headers:{RequestVerificationToken:token()}}).done(function(){}).fail(function(){})}function getShopAddress(n,t){return n.trim().endsWith("USA")&&(n=n.replace("USA","").trim()),n.endsWith(",")&&(n=n.slice(0,-1)),n.trim().endsWith(t)&&(n=n.replace(t,"")),n.trim()}function addSpinButtonNextUser(){$(".btn-next-user").addClass("disabled");$(".btn-next-user .fa").addClass("fa-circle-o-notch")}function removeSpinButtonNextUser(){$(".btn-next-user").removeClass("disabled");$(".btn-next-user .fa").removeClass("fa-circle-o-notch")}function checkAuthenticationExpiration(){function f(){swal({title:"Your session has expired.",text:"Please log in again.",type:cSwal_Icon_Warning,showLoaderOnConfirm:!0,allowEscapeKey:!1,allowOutsideClick:!1}).then(function(n){n&&redirectMain()})}var n=getObjFormAjax(cJsonGetAuthenticationExpiration,"");if(!isEmpty(n)){var t=JSON.parse(n),i=moment(t.currentTime,moment_date_format_mmddyyyyhhmmssa),r=moment(t.expiration,moment_date_format_mmddyyyyhhmmssa),u=r.diff(i)-6e4;_timeoutHandleSessionExpired=setTimeout(f,u)}}function koBindingHandlers(){ko.bindingHandlers.slickPickDesign={init:function(n,t,i){var u;$(n).empty();var r=ko.unwrap(t()),e=i(),f=i.get("type");r&&r.forEach(function(t){var i=$("<img>"),r;i.attr("src",t.giftCerImagesName());i.attr("class",t.isDefault()==!0?"slickPickDesign image isDefault theme default":"slickPickDesign image");t.isDefault()&&(vmViewIndex.giftCerImages.selectGiftCerImageId(t.giftCerImagesId()),vmViewIndex.giftCerImages.selectGiftCerImageName(t.giftCerImagesName()));isEmpty(f)?i.attr("data-bind","click:function (data, event) { $root.giftCerImages.clickImageSelected("+ko.toJSON(t)+" , event); }"):i.attr("data-bind","click:function (data, event) { $root.cart.clickShowUpdateImageSelected("+ko.toJSON(t)+" , event); }");i.attr("data-id",t.giftCerImagesId());r=$("<div>");r.append(i);$(n).append(r)});u={dot:!1,arrows:!0,infinite:!1,speed:300,slidesToShow:1,slidesToScroll:1,variableWidth:!0,nextArrow:'<div class="nextArrow"><span><i class="fa fa-arrow-right"><\/i><\/span><\/div>',prevArrow:'<div class="prevArrow arrow-none"><span><i class="fa fa-arrow-left"><\/i><\/span><\/div>',customPaging:function(){},responsive:[{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:745,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:827,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:991,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:1400,settings:{slidesToShow:1,slidesToScroll:1}},]}||{};$(n).slick(u);ko.utils.domNodeDisposal.addDisposeCallback(n,function(){$(n).slick("unslick")})},update:function(n,t){ko.unwrap(t());$(n).slick("setPosition");$(n).on("afterChange",function(n,t,i){n.target.childNodes.length>1&&(i===t.slideCount-t.options.slidesToShow?n.target.childNodes[2].classList.add("arrow-none"):n.target.childNodes[2].classList.remove("arrow-none"),i===0?n.target.childNodes[0].classList.add("arrow-none"):n.target.childNodes[0].classList.remove("arrow-none"))})}};ko.bindingHandlers.slickAmount={init:function(n,t,i){var r;$(n).empty();var e=ko.unwrap(t()),o=i.get("defaultValue"),s=i.get("inputValue"),h=i.get("inputEvent"),u=i.get("type");const f=vmViewIndex.globalConfig.showPayAmount();e.forEach(function(t){var i=$("<div>"),e=$("<div>"),r=$("<div>"),c=$("<div>"),h=$("<div>"),s=$('<input type="text"/>');o==t.giftCerValueId()?i.attr("class","slickAmount btn btn-lg box theme default-background-color-light isDefault"):i.attr("class","slickAmount btn btn-lg box theme default-background-color-light");isEmpty(u)?t.getAsPay()?(i.attr("data-bind","click:function (data, event) { $root.giftCerAmount.clickGiftCerCustomAmountFocus("+ko.toJSON(t)+" , event); }"),i.attr("data-container","body"),i.attr("data-toggle","popover"),i.attr("data-placement","top"),i.attr("title","Custom Amount"),i.attr("data-content","Please enter the amount"),i.addClass("popover-customAmount")):i.attr("data-bind","click:function (data, event) { $root.giftCerAmount.clickGiftCerAmount("+ko.toJSON(t)+" , event); }"):t.getAsPay()?i.attr("data-bind","click:function (data, event) { $root.cart.clickShowUpdateCustomDiscountFocus("+ko.toJSON(t)+" , event); }"):i.attr("data-bind","click:function (data, event) { $root.cart.clickShowUpdateGiftCerAmount("+ko.toJSON(t)+" , event); }");i.attr("data-id",t.giftCerValueId());f?(e.attr("class","descAmount"),r.attr("class","descPay")):(e.attr("class","descAmount descAmountOnly"),r.attr("class","descPay gb_hidden"));h.attr("class","descShowPrice");t.getAsPay()?(f?s.attr("class","descCustomAmount"):s.attr("class","descCustomAmount descAmountOnly"),s.attr("maxlength",5),isEmpty(u)?(s.attr("data-bind","value:$root.giftCerAmount.customAmount(), event:{change: $root.giftCerAmount.blurCustomAmount}"),r.attr("data-bind",'text: "Pay " + $root.giftCerAmount.customPayAmount()')):(s.attr("data-bind","value:$root.cart.currentCustomAmount(), event:{change: $root.cart.blurCustomAmount}"),r.attr("data-bind",'text: "Pay " + $root.cart.currentCustomPayAmount()')),i.append(s).append(r).append(c)):f?(e.attr("data-bind","text : toShowAmount("+t.getAmount()+")"),r.attr("data-bind",'text :"Pay " + toShowAmount('+t.payAmount()+")"),i.append(e).append(r)):(e.attr("data-bind","text : toShowAmount("+t.getAmount()+")"),r.attr("data-bind",'text :"Pay " + toShowAmount('+t.payAmount()+")"),t.discountAmount()>0||t.discountPercent()>0?(h.attr("data-bind",'text :"Your Price " + toShowAmount('+t.payAmount()+")"),i.append(e).append(h).append(r)):i.append(e).append(r));$(n).append(i)});isEmpty(u)?(r={arrows:!0,dots:!1,infinite:!1,speed:300,slidesToShow:5,slidesToScroll:1,nextArrow:'<span class="nextArrow"><i class="fa fa-arrow-right"><\/i><\/span>',prevArrow:'<span class="prevArrow"><i class="fa fa-arrow-left"><\/i><\/span>',responsive:[{breakpoint:480,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:767,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:991,settings:{slidesToShow:4,slidesToScroll:1}},{breakpoint:1199,settings:{slidesToShow:5,slidesToScroll:1}},]}||{},$(n).slick(r),ko.utils.domNodeDisposal.addDisposeCallback(n,function(){$(n).slick("unslick")})):(r={arrows:!0,dots:!1,infinite:!1,speed:300,slidesToShow:1,slidesToScroll:1,nextArrow:'<span class="nextArrow"><i class="fa fa-arrow-right"><\/i><\/span>',prevArrow:'<span class="prevArrow"><i class="fa fa-arrow-left"><\/i><\/span>',responsive:[{breakpoint:480,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:767,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:991,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:1199,settings:{slidesToShow:2,slidesToScroll:1}},]}||{},$(n).slick(r),ko.utils.domNodeDisposal.addDisposeCallback(n,function(){$(n).slick("unslick")}))},update:function(n,t){ko.unwrap(t());$(n).slick("setPosition");$(n).on("afterChange",function(n,t,i){n.target.childNodes.length>1&&(i===t.slideCount-t.options.slidesToShow?n.target.childNodes[2].classList.add("arrow-none"):n.target.childNodes[2].classList.remove("arrow-none"),i===0?n.target.childNodes[0].classList.add("arrow-none"):n.target.childNodes[0].classList.remove("arrow-none"))})}};ko.bindingHandlers.slickCartCheckOut={init:function(){},update:function(n,t){var i,r;$(n).empty();i=ko.unwrap(t());i&&($(n).attr("class","slider cart-slick"),i.forEach(function(t){var i=$("<div>"),r,u,p,h,c,w,f,l,b,k,e,d,a,o,g,v,s,nt,y;i.attr("class","card");r=$("<img>");r.attr("src",t.giftCerImagesName());r.attr("class","card-image");r.attr("data-id",t.giftCerImagesId());u=$("<span>");u.attr("class","card-from-header");p=$("<i>");p.attr("class","fa fa-user icon theme default");u.append(p);h=$("<span>");h.attr("class","card-from");h.append(t.from());u.append(h);c=$("<span>");c.attr("class","card-message");c.append(t.message());w=$("<label>");w.append("Amount");f=$("<span>");f.attr("class","card-payamount");f.append(w);f.append("$"+t.getAmount());l=$("<div>");l.attr("style","background-image: url("+cDefaultBarCode+");");l.attr("class","card-barcode");b=$("<hr>");b.attr("class","hr");k=$("<hr>");k.attr("class","hr");i.append(r);i.append(b);i.append(u);t.email().length>0&&(e=$("<span>"),e.attr("class","card-to-email-header"),d=$("<i>"),d.attr("class","fa fa-envelope icon theme default"),e.append(d),a=$("<span>"),a.attr("class","card-to-email-items"),a.append(t.email()),e.append(a),i.append(e));t.phone().length>0&&(o=$("<span>"),o.attr("class","card-to-phone-header"),g=$("<i>"),g.attr("class","fa fa-phone-square icon theme default"),o.append(g),v=$("<span>"),v.attr("class","card-to-phone-items"),v.append(t.phone()),o.append(v),i.append(o));s=$("<span>");s.attr("class","card-delivery-date-header");nt=$("<i>");nt.attr("class","fa fa-calendar-o icon theme default");s.append(nt);y=$("<span>");y.attr("class","card-delivery-date-items");y.append(moment(t.selectDate()).format("MM/DD/YYYY"));s.append(y);i.append(s);i.append(k);i.append(c);i.append(f);i.append(l);$(n).append(i)}));r={dot:!1,arrows:!0,infinite:!1,speed:300,slidesToShow:1,slidesToScroll:1,variableWidth:!0,nextArrow:'<div class="nextArrow"><span><i class="fa fa-arrow-right"><\/i><\/span><\/div>',prevArrow:'<div class="prevArrow arrow-none"><span><i class="fa fa-arrow-left"><\/i><\/span><\/div>',customPaging:function(){}};$(n).slick(r);$(n).on("afterChange",function(n,t,i){n.target.childNodes.length>1&&(i===t.slideCount-t.options.slidesToShow?n.target.childNodes[2].classList.add("arrow-none"):n.target.childNodes[2].classList.remove("arrow-none"),i===0?n.target.childNodes[0].classList.add("arrow-none"):n.target.childNodes[0].classList.remove("arrow-none"))});ko.utils.domNodeDisposal.addDisposeCallback(n,function(){$(n).slick("unslick")})}};ko.bindingHandlers.slickHistory={init:function(n,t,i){var u;$(n).empty();var r=ko.unwrap(t()),f=i(),e=i.get("type");r&&r.forEach(function(t){var u=$("<img>"),f,e,c,o,s,h,r,i,l;u.attr("src",t.giftCerImagesName());u.attr("class","slickHistory image");u.attr("data-id",t.giftCerImagesId());f=$("<div>");f.attr("class","message text-center");f.append(t.message());e=$("<div>");e.attr("class","card-body");e.append(f);c=$("<span>");c.append("$"+t.accountBalance());o=$("<li>");o.attr("class","list-group-item text-center font-weight-bold");o.append(c);s=$("<div>");s.attr("id","item-barcode"+t.giftCode());s.attr("class","barcode");h=$("<li>");h.attr("class","list-group-item text-center");h.append(s);r=$("<ul>");r.attr("class","list-group list-group-flush");r.append(h);r.append(o);i=$("<div>");i.attr("class","card mx-3");i.append(u);i.append(e);i.append(r);l=$("<div>");l.append(i);$(n).append(l)});u={dot:!1,arrows:!0,infinite:!1,speed:300,slidesToShow:1,slidesToScroll:1,variableWidth:!0,nextArrow:'<div class="nextArrowHistory"><span><i class="fa fa-arrow-right"><\/i><\/span><\/div>',prevArrow:'<div class="prevArrowHistory arrow-none"><span><i class="fa fa-arrow-left"><\/i><\/span><\/div>',customPaging:function(){},responsive:[{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:745,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:827,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:991,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:1400,settings:{slidesToShow:1,slidesToScroll:1}},]}||{};$(n).slick(u);ko.utils.domNodeDisposal.addDisposeCallback(n,function(){$(n).slick("unslick")})},update:function(n,t){ko.unwrap(t());$(n).slick("setPosition");$(n).on("afterChange",function(n,t,i){n.target.childNodes.length>1&&(i===t.slideCount-t.options.slidesToShow?n.target.childNodes[2].classList.add("arrow-none"):n.target.childNodes[2].classList.remove("arrow-none"),i===0?n.target.childNodes[0].classList.add("arrow-none"):n.target.childNodes[0].classList.remove("arrow-none"))})}}}
function DataCartViewModel(n,t,i){var r=this,u;i?(r.cartId=ko.observable(n),r.qty=ko.observable(t.qty()),r.giftCerImagesName=ko.observable(t.giftCerImagesName()),r.giftCerImagesId=ko.observable(t.giftCerImagesId()),r.giftCerValueId=ko.observable(t.giftCerValueId()),r.getAmount=ko.observable(t.getAmount()),r.payAmount=ko.observable(t.payAmount()),r.selectCustomId=ko.observable(isEmpty(t.selectCustomId)?t.selectCustomId:t.selectCustomId()),r.customAmount=ko.observable(t.customAmount()),r.customPayAmount=ko.observable(t.customPayAmount()),r.isCustomDiscount=ko.observable(t.isCustomDiscount()),u=ko.mapping.fromJSON(t.selectCheckBoxSendType()),r.selectCheckBoxSendType=ko.observableArray([]),ko.utils.arrayForEach(u(),function(n){var t=new DataSendTypeModel({giftCerSendTypeId:n.giftCerSendTypeId(),giftCerSendTypeName:n.giftCerSendTypeName()});r.selectCheckBoxSendType.push(t)}),r.email=ko.observable(t.email()),r.phone=ko.observable(t.phone()),r.from=ko.observable(t.from()),r.message=ko.observable(t.message()),r.selectDate=ko.observable(moment(t.selectDate()).format(moment_date_format_yyyymmddthhmmss)),r.todayAsap=ko.observable(t.todayAsap())):(r.cartId=ko.observable(n),r.qty=ko.observable(1),r.giftCerImagesName=ko.observable(t.giftCerImages.selectGiftCerImageName()),r.giftCerImagesId=ko.observable(t.giftCerImages.selectGiftCerImageId()),r.giftCerValueId=ko.observable(t.giftCerAmount.selectGiftCerValueId()),r.getAmount=ko.observable(t.giftCerAmount.selectGetAmount()),r.payAmount=ko.observable(t.giftCerAmount.selectPayAmount()),r.selectCustomId=ko.observable(t.giftCerAmount.selectCustomId()),r.customAmount=ko.observable(t.giftCerAmount.customAmount()),r.customPayAmount=ko.observable(t.giftCerAmount.customPayAmount()),r.isCustomDiscount=ko.observable(t.giftCerAmount.isCustomDiscount()),r.selectCheckBoxSendType=ko.observableArray([]),r.email=ko.observable(t.giftCerDetail.email()),r.phone=ko.observable(t.giftCerDetail.phone()),r.from=ko.observable(t.giftCerDetail.from()),r.message=ko.observable(t.giftCerDetail.message()),r.selectDate=ko.observable(t.giftCerDetail.isAsap()?moment(_currentTime.toDate()).format(moment_date_format_yyyymmddthhmmss):moment(t.giftCerDetail.selectDate()).format(moment_date_format_yyyymmddthhmmss)),r.todayAsap=ko.observable(t.giftCerDetail.isAsap()?!0:!1),ko.utils.arrayForEach(t.giftCerDetail.selectCheckBoxSendType(),function(n){r.selectCheckBoxSendType.push(n)}))}function DataSendTypeModel(n){var t=this;t.giftCerSendTypeId=ko.observable(n.giftCerSendTypeId);t.giftCerSendTypeName=ko.observable(n.giftCerSendTypeName)}function DataOrderHistoryModel(n,t,i){var r=this;r.giftCerImagesId=ko.observable(t.giftCerImagesId);r.giftCerImagesName=ko.observable(cPathFileBase+cGiftCerPath+"/"+cMobile+"/"+i.giftCerImagesName);r.giftCerSendTypeId=ko.observable(t.giftCerSendTypeId);r.giftCode=ko.observable(t.giftCode);r.message=ko.observable(t.message);r.accountBalance=ko.observable(n.accountBalance).extend({numeric:2});r.amtOpen=ko.observable(n.amtOpen).extend({numeric:2})}function DataProfileUpdateViewModel(n,t,i){var r=this;r.firstName=ko.observable(n);r.lastName=ko.observable(t);r.ownerPhone=ko.observable(i)}
function GlobalConfigViewModel(n){var t=this,i=JSON.parse(n),r;(isEmpty(i)||n==null)&&redirectMain();t.shopName=ko.observable(filterGlobalConfig(i,gcShopName));t.shopCode=ko.observable(filterGlobalConfig(i,gcShopCode));t.shopZipCode=ko.observable(filterGlobalConfig(i,gcShopPostal));r=filterGlobalConfig(i,gcShopStreet);t.shopStreet=ko.observable(getShopAddress(r,t.shopZipCode()));t.shopPhone=ko.observable(getPhoneFormatUs(filterGlobalConfig(i,gcShopPhone)));t.payByCash=ko.observable(filterGlobalConfig(i,gcPayByCash));t.payByCredit=ko.observable(filterGlobalConfig(i,gcPayByCredit));t.shopLogo=ko.observable(filterGlobalConfig(i,gcShopLogo));t.shopLastUpdate=ko.observable(filterGlobalConfig(i,gcShopLastUpdate));t.shopDesc=t.shopPhone()+" | "+t.shopStreet();t.amountDesc=ko.observable(filterGlobalConfig(i,"giftcer-amountdesc"));t.showPayAmount=ko.observable(filterGlobalConfig(i,"giftcer-show-payamount")===null?!0:filterGlobalConfig(i,"giftcer-show-payamount")==="0"?!1:!0);t.captchaEnable=ko.observable(filterGlobalConfig(i,"captcha-enable")===null?!0:filterGlobalConfig(i,"captcha-enable")==="0"?!1:!0);t.captchaKeepAlive=ko.observable(filterGlobalConfig(i,"captcha-keep-alive")===null?!0:filterGlobalConfig(i,"captcha-keep-alive")==="0"?!1:!0);t.showGuestCheckOut=ko.observable(filterGlobalConfig(i,"show-guest-checkout"));isEmpty(t.showGuestCheckOut())&&t.showGuestCheckOut("1");cPathFileBase=cProtocal+"://img.smiledining.com/"+t.shopCode()+"/";t.shopLogo().length>0&&t.shopLogo(cProtocal+"://img.smiledining.com/"+t.shopCode()+"/"+t.shopLogo())}function LoadingViewModel(){var n=this;n.loadingVisible=ko.observable(!1);n.closeOnOutsideClick=ko.observable(!1);n.showIndicator=ko.observable(!0);n.showPane=ko.observable(!0);n.shading=ko.observable(!0);n.position=ko.observable("");n.loadOptions={visible:n.loadingVisible,showIndicator:n.showIndicator,showPane:n.showPane,shading:n.shading,closeOnOutsideClick:n.closeOnOutsideClick,shadingColor:"rgba(0,0,0,0.4)",position:{"of":n.position()},onShown:function(){},onHidden:function(){}};n.showLoadPanel=function(){n.loadingVisible(!0)}}function GiftCerImagesViewModel(n,t,i){function s(n){for(var u,f=_.size(r.giftCerImagesMobile()),t=.75,i=0;i<f;i++)u=$(".pickDesign .section:eq(0) .slide:eq("+i+")"),t+=.15,n==!0?u.animate({left:"0"},t*1e3,function(){}):u.removeAttr("style");n?setTimeout(function(){vmViewIndex.giftCerImages.showImageDefault(n)},t*1e3):vmViewIndex.giftCerImages.showImageDefault(!1)}function h(n){var t=$(".pickDesign .back"),i=$(".pickDesign .section");i.animate({width:"toggle"});n==!0?(s(!0),t.fadeIn()):(t.fadeOut(),s(!1))}function e(){ko.utils.arrayForEach(r.giftCerImagesMobile(),function(n){n.isDefault(!1)});ko.utils.arrayForEach(r.giftCerImagesTablet(),function(n){n.isDefault(!1)});ko.utils.arrayForEach(r.giftCerImagesDesktop(),function(n){n.isDefault(!1)});ko.utils.arrayForEach(r.giftCerImagesCart(),function(n){n.isDefault(!1)});$(".pickDesign .slickPickDesign").removeClass("isDefault theme default")}function o(n){var r=ko.utils.arrayFilter(vmViewIndex.giftCerImages.giftCerImagesMobile(),function(t){return t.giftCerImagesId()==n}),t,i;_.head(r).isDefault(!0);t=ko.utils.arrayFilter(vmViewIndex.giftCerImages.giftCerImagesTablet(),function(t){return t.giftCerImagesId()==n});_.head(t).isDefault(!0);i=ko.utils.arrayFilter(vmViewIndex.giftCerImages.giftCerImagesDesktop(),function(t){return t.giftCerImagesId()==n});_.head(i).isDefault(!0);$('.pickDesign .slickPickDesign[data-id="'+n+'"]').addClass("isDefault theme default")}var r=this,f,u;$(".pickDesign .section").hide();r.giftCerImagesMobile=ko.observableArray([]);r.giftCerImagesTablet=ko.observableArray([]);r.giftCerImagesDesktop=ko.observableArray([]);r.giftCerImagesCart=ko.observableArray([]);r.resetImagesId=ko.observable("");r.resetImagesName=ko.observable("");r.selectGiftCerImageId=ko.observable("");r.selectGiftCerImageName=ko.observable("");ko.mapping.fromJS(JSON.parse(n),{},r.giftCerImagesMobile);ko.mapping.fromJS(JSON.parse(t),{},r.giftCerImagesTablet);ko.mapping.fromJS(JSON.parse(i),{},r.giftCerImagesDesktop);ko.mapping.fromJS(JSON.parse(n),{},r.giftCerImagesCart);f=ko.utils.arrayFilter(r.giftCerImagesMobile(),function(n){return n.isDefault()==!0});isEmpty(f)?(u=_.head(r.giftCerImagesMobile()),r.resetImagesId(u.giftCerImagesId()),r.resetImagesName(u.giftCerImagesName())):(u=_.head(f),r.resetImagesId(u.giftCerImagesId()),r.resetImagesName(u.giftCerImagesName()));r.resetImages=function(){e();o(vmViewIndex.giftCerImages.resetImagesId());r.selectGiftCerImageId(vmViewIndex.giftCerImages.resetImagesId());r.selectGiftCerImageName(vmViewIndex.giftCerImages.resetImagesName());$(".phablet .pickDesign .images").slick("slickGoTo",0);$(".tablet .pickDesign .images").slick("slickGoTo",0);$(".desktop .pickDesign .images").slick("slickGoTo",0)};r.clickImageSelected=function(n){var t="";isEmpty(n.giftCerImagesId)?(t=n.giftCerImagesId(),r.selectGiftCerImageId(n.giftCerImagesId()),r.selectGiftCerImageName(n.giftCerImagesName())):(t=n.giftCerImagesId,r.selectGiftCerImageId(n.giftCerImagesId),r.selectGiftCerImageName(n.giftCerImagesName));e();o(t)};r.clickMore=function(){h(!0)};r.clickBackMore=function(){h(!1)};r.clickMoreImageSelected=function(n){var t="";isEmpty(n.giftCerImagesId)?(t=n.giftCerImagesId(),r.selectGiftCerImageId(n.giftCerImagesId()),r.selectGiftCerImageName(n.giftCerImagesName())):(t=n.giftCerImagesId,r.selectGiftCerImageId(n.giftCerImagesId),r.selectGiftCerImageName(n.giftCerImagesName));e();o(n.giftCerImagesId())};r.showImageDefault=ko.observable(!1)}function GiftCerAmountViewModel(n){function r(n,t,i){var r;if(t>0)r=n-rountTwo(t),r<=0?vmViewIndex.giftCerAmount.customPayAmount(toShowAmount(0)):vmViewIndex.giftCerAmount.customPayAmount(toShowAmount(rountTwo(r)));else{const t=percentCalculation(n,i);r=n-rountTwo(t);vmViewIndex.giftCerAmount.customPayAmount(toShowAmount(rountTwo(r)))}}function u(n,t){var i=removeDollar($(t.target).val());return i=$.isNumeric(i)?rountTwo(i):0,i<0&&(i=0),i}var t=this;t.dataGiftCerAmount=ko.observableArray([]);t.selectGiftCerValueId=ko.observable();t.selectGetAmount=ko.observable(0);t.selectPayAmount=ko.observable(0);t.resetGiftCerValueId=ko.observable();t.resetGetAmount=ko.observable(0);t.resetPayAmount=ko.observable(0);t.selectCustomId=ko.observable();t.customAmount=ko.observable(cCustomAmount);t.customPayAmount=ko.observable(toShowAmount(0));t.isCustomDiscount=ko.observable(!1);ko.mapping.fromJS(JSON.parse(n),{},t.dataGiftCerAmount);const i=_.head(t.dataGiftCerAmount());isEmpty(i)||(t.resetGiftCerValueId(i.giftCerValueId()),t.resetGetAmount(i.getAmount()),t.resetPayAmount(i.payAmount()),t.selectGiftCerValueId(i.giftCerValueId()),t.selectGetAmount(i.getAmount()),t.selectPayAmount(i.payAmount()));t.resetAmount=function(){t.selectGiftCerValueId(t.resetGiftCerValueId());t.selectGetAmount(t.resetGetAmount());t.selectPayAmount(t.resetPayAmount());t.customAmount(cCustomAmount);t.customPayAmount(toShowAmount(0));$(".descriptionPreview .slickAmount").removeClass("isDefault");$('.descriptionPreview [data-id="'+t.resetGiftCerValueId()+'"]').addClass("isDefault")};t.clickGiftCerCustomAmountFocus=function(n){t.isCustomDiscount(!0);t.selectCustomId(n.giftCerValueId);t.selectGiftCerValueId(n.giftCerValueId);$(".descCustomAmount").focus();$(".descCustomAmount").select();t.customAmount()===cCustomAmount?(t.selectGetAmount(parseFloat(removeDollar("0"))),t.selectPayAmount(parseFloat(removeDollar("0")))):(t.selectGetAmount(parseFloat(removeDollar(t.customAmount()))),t.selectPayAmount(parseFloat(removeDollar(t.customPayAmount()))));$(".descriptionPreview .slickAmount").removeClass("isDefault");$('.descriptionPreview [data-id="'+n.giftCerValueId+'"]').addClass("isDefault")};t.clickGiftCerAmount=function(n){t.isCustomDiscount(!1);t.selectGiftCerValueId(n.giftCerValueId);isEmpty(n.discountAmount)||isEmpty(n.discountPercent)||(n.discountAmount>=0&&n.discountPercent>=0?(t.selectGetAmount(n.getAmount),t.selectPayAmount(n.payAmount)):($(".descCustomAmount").focus(),$(".descCustomAmount").select()),$(".descriptionPreview .slickAmount").removeClass("isDefault"),$('.descriptionPreview [data-id="'+n.giftCerValueId+'"]').addClass("isDefault"))};t.blurCustomAmount=function(n,i){var w,e,f,c,l,a,v,p;const y=u(n,i);if(w=!1,t.customAmount()==toShowAmount(0)&&t.customAmount(toShowAmount(.01)),t.customAmount()==cCustomAmount&&t.customAmount(toShowAmount(.01)),y===0?t.customAmount(cCustomAmount):t.customAmount(toShowAmount(y)),e=convertStringToNumber(removeDollar(t.customAmount())),isNaN(e)&&(e=0),t.selectGetAmount(e),vmViewIndex.giftCerAmount.customPayAmount(toShowAmount(e)),f=_.find(vmViewIndex.giftCerCustomDiscount.dataGiftCerCustomDiscount(),function(n){return e>=n.min()&&e<=n.max()}),f!=undefined)if(vmViewIndex.giftCerAmount.customPayAmount(toShowAmount(e)),f.allDate()&&f.allTime())t.selectGiftCerValueId(t.selectCustomId()),r(e,f.amountOff(),f.percentOff());else{var s=!0,h=!0,o=moment(_currentTime).format("YYYY-MM-DD");f.allDate()||(s=!1,c=moment(f.startDate(),moment_date_format_yyyymmddthhmmss).format("YYYY-MM-DD"),l=moment(f.endDate(),moment_date_format_yyyymmddthhmmss).format("YYYY-MM-DD"),moment(o).isBetween(c,l)?s=!0:(moment(o).isSame(c)||moment(o).isSame(l))&&(s=!0));f.allTime()||(h=!1,a=moment(o+" "+f.startTime(),moment_date_format_yyyymmddthhmmss),v=moment(o+" "+f.endTime(),moment_date_format_yyyymmddthhmmss),_currentTime.isBetween(a,v)?h=!0:(_currentTime.isSame(a)||_currentTime.isSame(v))&&(h=!0));s&&h&&(t.selectGiftCerValueId(t.selectCustomId()),r(e,f.amountOff(),f.percentOff()))}p=convertStringToNumber(removeDollar(t.customPayAmount()));vmViewIndex.giftCerAmount.selectPayAmount(p)}}function GiftCerCustomDiscount(n){var t=this;t.dataGiftCerCustomDiscount=ko.observableArray([]);ko.mapping.fromJS(JSON.parse(n),{},t.dataGiftCerCustomDiscount)}function GiftCerDetailViewModel(n,t){var i=this,r;i.allDataSendType=ko.observableArray([]);i.dataSendType=ko.observableArray([]);i.selectCheckBoxSendType=ko.observableArray([]);i.showDataSendType=ko.observableArray([]);i.email=ko.observable("");i.phone=ko.observable("");i.from=ko.observable("");i.message=ko.observable("");i.selectDate=ko.observable();i.isAsap=ko.observable(!0);i.isSchedule=ko.observable(!1);const u=moment(t,moment_date_format_mmddyyyyhhmmssa).add(1,"days").toDate();i.selectDate=ko.observable(u);ko.mapping.fromJS(JSON.parse(n),{},i.allDataSendType);r=ko.utils.arrayFilter(i.allDataSendType(),function(n){return n.giftCerSendTypeName()!=cAll});ko.utils.arrayForEach(r,function(n){var t=new DataSendTypeModel({giftCerSendTypeId:n.giftCerSendTypeId(),giftCerSendTypeName:n.giftCerSendTypeName()});i.dataSendType.push(t);i.selectCheckBoxSendType.push(t);i.showDataSendType.push(t)});i.deliveryDate=ko.observable({displayFormat:"MM/dd/yyyy",value:i.selectDate(),min:i.selectDate(),disabled:i.isAsap,onValueChanged:function(n){i.selectDate(n.value)}});i.msgCountCharacter=ko.pureComputed(function(){const n=i.message().length;return countTextMessage(n)});i.visibleShowText=ko.pureComputed(function(){const n=i.selectCheckBoxSendType();if(n.length>0){const t=_.find(n,function(n){return n.giftCerSendTypeName()==cTextMessage});return isEmpty(t)||t.length<=0?(i.selectCheckBoxSendType().length==0&&validationCheckBox(!1),i.phone(""),!1):(validationCheckBox(!0),!0)}return!1});i.visibleShowEmail=ko.pureComputed(function(){const n=i.selectCheckBoxSendType();if(n.length>0){const t=_.find(n,function(n){return n.giftCerSendTypeName()==cEmail});return isEmpty(t)||t.length<=0?(i.selectCheckBoxSendType().length==0&&validationCheckBox(!1),i.email(""),!1):(validationCheckBox(!0),!0)}return!1});i.deliveryBy=ko.pureComputed(function(){var n="";const t=i.selectCheckBoxSendType();return t.forEach(function(t){isEmpty(t)?n="":n.length==0?n=t.giftCerSendTypeName():n+=" and "+t.giftCerSendTypeName()}),"Delivery by "+n});i.clickGiftCerDetail=function(){const n=verifyDataBeforeAddToCart();if(isEmpty(n)){const t=$(".main"),n=$(".cardDetail");if(n.off("animationend"),n.removeClass("animated bounceOut"),t.removeClass("animated bounceIn"),t.addClass("animated bounceOut"),window.matchMedia("(prefers-reduced-motion)"))t.hide(),n.show(),n.find(".preview").show(),n.addClass("animated bounceIn");else t.on("animationend",function(){t.hide();n.show();n.find(".preview").show();n.addClass("animated bounceIn")})}else showMsgErrorVerifyAddToCart(n)};i.clearDetail=function(){i.email("");i.phone("");i.from("");i.message("");i.isAsap(!0);i.isSchedule(!1);i.selectCheckBoxSendType.removeAll();i.dataSendType.removeAll();ko.utils.arrayForEach(r,function(n){var t=new DataSendTypeModel({giftCerSendTypeId:n.giftCerSendTypeId(),giftCerSendTypeName:n.giftCerSendTypeName()});i.dataSendType.push(t);i.selectCheckBoxSendType.push(t)});validationCheckBox(!0);vmViewIndex.giftCerDetail.clearInvalidateError()};i.checkAsap=function(){return i.isAsap(!0),i.isSchedule(!1),!0};i.checkSchedule=function(){return i.isAsap(!1),i.isSchedule(!0),!0};i.clearInvalidateError=function(){$(".inputRecipient .email").removeClass(cCssInputValidateError);$(".inputRecipient .phone").removeClass(cCssInputValidateError);$(".inputPurchaser input").removeClass(cCssInputValidateError);$(".inputMessage textarea").removeClass(cCssInputValidateError)};setMaskPhone2()}function CustomerViewModel(n){var t=this;isEmpty(n)?(t.customerId=ko.observable(""),t.firstName=ko.observable(""),t.lastName=ko.observable(""),t.flag=ko.observable(""),t.email=ko.observable(""),t.isExternalLogIn=ko.observable(!1),t.ownerPhone=ko.observable("")):ko.mapping.fromJSON(n,{},t);t.profileUpdate=new DataProfileUpdateViewModel(t.firstName(),t.lastName(),t.ownerPhone());t.clickDeleteProfile=function(){swalConfirmDeleteProfile()}}function GuestViewModel(n){var t=this;isEmpty(n)?(t.guestId=ko.observable(""),t.firstName=ko.observable(""),t.lastName=ko.observable(""),t.email=ko.observable(""),t.phone=ko.observable(""),t.createOn=ko.observable("")):ko.mapping.fromJSON(n,{},t)}function CustomerAddressBillingCurrentViewModel(n){var t=this;isEmpty(n)?(t.active=ko.observable(!0),t.customerAddresBillingID=ko.observable(""),t.customerId=ko.observable(""),t.line=ko.observable(1),t.address=ko.observable(""),t.city=ko.observable(""),t.state=ko.observable(""),t.postTal=ko.observable(""),t.latitude=ko.observable(""),t.longitude=ko.observable(""),t.phone=ko.observable(""),t.isDefault=ko.observable(!1)):ko.mapping.fromJSON(n,{},t)}function CartViewModel(n,t,i){function c(n,t,i){var u;if(t>0)u=n-rountTwo(t),u<=0?r.currentCustomPayAmount(toShowAmount(0)):r.currentCustomPayAmount(toShowAmount(rountTwo(u)));else{const t=percentCalculation(n,i);u=n-rountTwo(t);r.currentCustomPayAmount(toShowAmount(rountTwo(u)))}}function v(n,t){var i=removeDollar($(t.target).val());return i=$.isNumeric(i)?rountTwo(i):0,i<0&&(i=0),i}function e(){ko.utils.arrayForEach(vmViewIndex.giftCerImages.giftCerImagesCart(),function(n){n.isDefault(!1)});$("#modalCartUpdate .slickPickDesign").removeClass("isDefault theme default")}function o(n){var r=ko.utils.arrayFilter(vmViewIndex.giftCerImages.giftCerImagesCart(),function(t){return t.giftCerImagesId()==n}),i=_.head(r),t;i.isDefault(!0);t=ko.utils.arrayFilter(vmViewIndex.cart.data(),function(n){return n.cartId()==vmViewIndex.cart.currentCartId()});_.head(t).giftCerImagesId(n);_.head(t).giftCerImagesName(i.giftCerImagesName());$('#modalCartUpdate .slickPickDesign[data-id="'+n+'"]').addClass("isDefault theme default")}function u(){$("#modalCartUpdate .slickAmount").removeClass("isDefault")}function l(n){var t,u,f,i;isEmpty(n.giftCerValueId)?(t=n.giftCerValueId(),u=n.getAmount(),f=n.payAmount()):(t=n.giftCerValueId,u=n.getAmount,f=n.payAmount);i=ko.utils.arrayFilter(vmViewIndex.cart.data(),function(n){return n.cartId()==vmViewIndex.cart.currentCartId()});_.head(i).giftCerValueId(t);_.head(i).getAmount(u);_.head(i).payAmount(f);$('#modalCartUpdate .slickAmount[data-id="'+t+'"]').addClass("isDefault");r.calculateCart()}function s(n){var i,u,f,e,t;isEmpty(n.giftCerValueId)?(i=n.giftCerValueId(),u=n.getAmount(),f=n.payAmount(),e=n.getAsPay()):(i=n.giftCerValueId,u=n.getAmount,f=n.payAmount,e=n.getAsPay);t=ko.utils.arrayFilter(vmViewIndex.cart.data(),function(n){return n.cartId()==vmViewIndex.cart.currentCartId()});_.head(t).giftCerValueId(i);_.head(t).getAmount(u);_.head(t).payAmount(f);e?(_.head(t).isCustomDiscount(!0),_.head(t).customAmount(u),_.head(t).customPayAmount(f)):(_.head(t).isCustomDiscount(!1),_.head(t).customAmount(0),_.head(t).customPayAmount(0));$('#modalCartUpdate .slickAmount[data-id="'+i+'"]').addClass("isDefault");r.calculateCart()}function f(n){const t=$(".checkboxDelivery label i"),i="no-after";n?(t.removeClass(i),t.removeClass(cCssInputValidateError)):(t.addClass(i),t.addClass(cCssInputValidateError))}var r=this,h;r.data=ko.observableArray([]);r.currentCartId=ko.observable();r.currentGiftCerValueId=ko.observable();r.currentPayAmount=ko.observable(0);r.currentGetAmount=ko.observable(0);r.currentDataSendType=ko.observableArray([]);r.allDataSendType=ko.observableArray([]);r.currentCheckBoxSendType=ko.observableArray([]);r.currentEmail=ko.observable("");r.currentPhone=ko.observable("");r.currentFrom=ko.observable("");r.currentMessage=ko.observable("");r.currentSelectDate=ko.observable();r.currentSelectCustomId=ko.observable();r.currentCustomAmount=ko.observable(cCustomAmount);r.currentCustomPayAmount=ko.observable(toShowAmount(0));r.currentIsCustomDiscount=ko.observable(!1);r.paymentType=ko.observable("CREDIT");r.ccNumber=ko.observable("");r.ccName=ko.observable("");r.ccExpiry=ko.observable("");r.ccCVC=ko.observable("");r.ccBillingZip=ko.observable("");r.ccType=ko.observable("");r.ccBillingAddress=ko.observable("");r.billingAddressLatitude=ko.observable("");r.billingAddressLongitude=ko.observable("");r.billingAddressCity=ko.observable("");r.billingAddressSubCity=ko.observable("");r.billingAddressState=ko.observable("");r.invalidAddress=ko.observable("");r.isAddressChange=ko.observable(!1);r.showPopupCart=ko.observable(!1);isEmpty(i)||i=="null"||(r.customerAddressBillingData=new CustomerAddressBillingCurrentViewModel(JSON.stringify(JSON.parse(i))),r.ccBillingAddress(r.customerAddressBillingData.address()),r.billingAddressLatitude(r.customerAddressBillingData.latitude()),r.billingAddressLongitude(r.customerAddressBillingData.longitude()),r.billingAddressCity(r.customerAddressBillingData.city()),r.billingAddressSubCity(""),r.billingAddressState(r.customerAddressBillingData.state()),r.ccBillingZip(r.customerAddressBillingData.postTal()));r.subTotal=ko.observable(0);r.discount=ko.observable(0);r.grandTotal=ko.observable(0);r.currentIsAsap=ko.observable(!0);r.currentIsSchedule=ko.observable(!1);ko.mapping.fromJS(JSON.parse(n),{},r.allDataSendType);h=ko.utils.arrayFilter(r.allDataSendType(),function(n){return n.giftCerSendTypeName()!=cAll});r.summaryTotal=ko.pureComputed(function(){return rountTwo(r.grandTotal())});r.sumQty=ko.pureComputed(function(){var n=0;return r.data().length>0&&ko.utils.arrayForEach(r.data(),function(t){n+=t.qty()}),n});r.dataObj=ko.pureComputed(function(){return ko.toJSON(r.data())});const a=moment(t,moment_date_format_mmddyyyyhhmmssa).add(1,"days").toDate();r.currentSelectDate(a);r.checkAsap=function(){return r.currentIsAsap(!0),r.currentIsSchedule(!1),!0};r.checkSchedule=function(){return r.currentIsAsap(!1),r.currentIsSchedule(!0),!0};r.currentDeliveryDate=ko.observable({displayFormat:"MM/dd/yyyy",value:r.currentSelectDate(),min:r.currentSelectDate(),acceptCustomValue:!1,disabled:r.currentIsAsap,onValueChanged:function(n){r.currentSelectDate(n.value)}});r.clickSubmitGiftCer=function(n){var t;!0&&(t=1,isEmpty(_.last(vmViewIndex.cart.data()))||(t=_.last(vmViewIndex.cart.data()).cartId()+1),vmViewIndex.cart.data.push(new DataCartViewModel(t,n,!1)),addItemStore(t,n),vmViewIndex.giftCerImages.resetImages(),vmViewIndex.giftCerAmount.resetAmount(),vmViewIndex.giftCerDetail.clearDetail());r.calculateCart()};r.clickShowUpdate=function(n){var t,i;r.currentCheckBoxSendType([]);r.currentDataSendType([]);r.currentCartId(n.cartId());r.currentGiftCerValueId(n.giftCerValueId());r.currentGetAmount(n.getAmount());r.currentPayAmount(n.payAmount());r.currentEmail(n.email());r.currentPhone(n.phone());r.currentFrom(n.from());r.currentMessage(n.message());r.currentIsAsap(n.todayAsap());r.currentIsSchedule(!n.todayAsap());n.customAmount()===0?r.currentCustomAmount(cCustomAmount):r.currentCustomAmount(n.customAmount());r.currentCustomPayAmount(n.customPayAmount());r.currentIsCustomDiscount(n.isCustomDiscount());ko.utils.arrayForEach(h,function(t){var i=new DataSendTypeModel({giftCerSendTypeId:t.giftCerSendTypeId(),giftCerSendTypeName:t.giftCerSendTypeName()});r.currentDataSendType.push(i);ko.utils.arrayForEach(n.selectCheckBoxSendType(),function(n){n.giftCerSendTypeId()==t.giftCerSendTypeId()&&r.currentCheckBoxSendType.push(i)})});r.currentDeliveryDate({value:n.selectDate()});r.currentSelectDate(n.selectDate());u();l(n);t=vmViewIndex.giftCerAmount.dataGiftCerAmount().length-1;ko.utils.arrayForEach(vmViewIndex.giftCerAmount.dataGiftCerAmount(),function(i,r){i.giftCerValueId()==n.giftCerValueId()&&(t=r)});$("#modalCartUpdate .amount").slick("slickGoTo",t);$('#modalCartUpdate .slickAmount[data-id="'+n.giftCerValueId()+'"]');e();o(n.giftCerImagesId());i=vmViewIndex.giftCerImages.giftCerImagesCart().length-1;ko.utils.arrayForEach(vmViewIndex.giftCerImages.giftCerImagesCart(),function(i,r){i.giftCerImagesId()==n.giftCerImagesId()&&(t=r)});$("#modalCartUpdate .images").slick("slickGoTo",t);setStore("storeModalCartUpdate",ko.toJS(n));r.showPopupCart()&&r.clickBackCart();vmViewIndex.giftCerDetail.clearInvalidateError();$("#modalCartUpdate").modal("show")};r.clickRemove=function(n){var t=ko.utils.arrayFilter(r.data(),function(t){return t.cartId()==n.cartId()});r.data.removeAll(t);deleteItemStore(n.cartId());r.calculateCart()};r.calculateCart=function(){var n=0,t=0;ko.utils.arrayForEach(r.data(),function(i){n+=i.getAmount();t+=i.payAmount()});r.subTotal(rountTwo(n));r.grandTotal(rountTwo(t));r.discount(rountTwo(r.subTotal()-r.grandTotal()))};r.showUpdateVisibleShowText=ko.pureComputed(function(){const t=r.currentCheckBoxSendType(),n=_.find(t,function(n){return n.giftCerSendTypeName()==cTextMessage});return isEmpty(n)||n.length<=0?(r.currentCheckBoxSendType().length==0&&f(!1),!1):(f(!0),!0)});r.showUpdateVisibleShowEmail=ko.pureComputed(function(){const t=r.currentCheckBoxSendType(),n=_.find(t,function(n){return n.giftCerSendTypeName()==cEmail});return isEmpty(n)||n.length<=0?(r.currentCheckBoxSendType().length==0&&f(!1),!1):(f(!0),!0)});r.showUpdateMsgCountCharacter=ko.pureComputed(function(){const n=r.currentMessage().length;return countTextMessage(n)});r.clickShowUpdateImageSelected=function(n){var t="";t=isEmpty(n.giftCerImagesId)?n.giftCerImagesId():n.giftCerImagesId;e();o(t)};r.clickShowUpdateGiftCerAmount=function(n){r.currentIsCustomDiscount(!1);r.currentGiftCerValueId(n.giftCerValueId);isEmpty(n.discountAmount)||isEmpty(n.discountPercent)||(n.discountAmount>=0&&n.discountPercent>=0?(r.currentGetAmount(n.getAmount),r.currentPayAmount(n.payAmount)):($("#modalCartUpdate .descCustomAmount").focus(),$("#modalCartUpdate .descCustomAmount").select()),u(),s(n))};r.blurCustomAmount=function(n,t){var d,f,i,l,a,y,p,w,b;const k=v(n,t);if(d=!1,r.currentCustomAmount(toShowAmount(k)),r.currentCustomAmount()==toShowAmount(0)&&(r.currentCustomAmount(toShowAmount(.01)),r.currentCustomAmount(cCustomAmount)),f=convertStringToNumber(removeDollar(r.currentCustomAmount())),isNaN(f)&&(f=0),r.currentGetAmount(f),r.currentCustomPayAmount(toShowAmount(f)),i=_.find(vmViewIndex.giftCerCustomDiscount.dataGiftCerCustomDiscount(),function(n){return f>=n.min()&&f<=n.max()}),i!=undefined)if(r.currentCustomPayAmount(toShowAmount(f)),i.allDate()&&i.allTime())r.currentGiftCerValueId(r.currentSelectCustomId()),c(f,i.amountOff(),i.percentOff());else{var o=!0,h=!0,e=moment(_currentTime).format("YYYY-MM-DD");i.allDate()||(o=!1,l=moment(i.startDate(),moment_date_format_yyyymmddthhmmss).format("YYYY-MM-DD"),a=moment(i.endDate(),moment_date_format_yyyymmddthhmmss).format("YYYY-MM-DD"),moment(e).isBetween(l,a)?o=!0:(moment(e).isSame(l)||moment(e).isSame(a))&&(o=!0));i.allTime()||(h=!1,y=moment(e+" "+i.startTime(),moment_date_format_yyyymmddthhmmss),p=moment(e+" "+i.endTime(),moment_date_format_yyyymmddthhmmss),_currentTime.isBetween(y,p)?h=!0:(_currentTime.isSame(y)||_currentTime.isSame(p))&&(h=!0));o&&h&&(r.currentGiftCerValueId(r.currentSelectCustomId()),c(f,i.amountOff(),i.percentOff()))}else r.currentGiftCerValueId(r.currentSelectCustomId());w=convertStringToNumber(removeDollar(r.currentCustomPayAmount()));r.currentPayAmount(w);b={giftCerValueId:r.currentGiftCerValueId(),getAmount:r.currentGetAmount(),payAmount:r.currentPayAmount(),getAsPay:!0};u();s(b)};$("#modalCartUpdate").on("hidden.bs.modal",function(){var t=getStore("btnSaveUpdate"),n;t||(n=getStore("storeModalCartUpdate"),u(),l(n),e(),o(n.giftCerImagesId));clearStore("btnSaveUpdate");clearStore("storeModalCartUpdate")});r.clickShowUpdateCustomDiscountFocus=function(n){r.currentIsCustomDiscount(!0);r.currentSelectCustomId(n.giftCerValueId);r.currentCustomAmount()===cCustomAmount||isNaN(r.currentGetAmount())||isEmpty(r.currentGetAmount())?(r.currentGetAmount(parseFloat(removeDollar("0"))),r.currentPayAmount(parseFloat(removeDollar("0")))):(r.currentGetAmount(convertStringToNumber(removeDollar(r.currentCustomAmount()))),r.currentPayAmount(convertStringToNumber(removeDollar(r.currentCustomPayAmount()))));var t={giftCerValueId:n.giftCerValueId,getAmount:r.currentGetAmount(),payAmount:r.currentPayAmount(),getAsPay:n.getAsPay};u();s(t)};r.saveGiftCerDetail=function(){var t=!0,n;r.currentCheckBoxSendType().length==0?($(".checkboxDelivery i").addClass("no-after"),$(".checkboxDelivery i").addClass(cCssInputValidateError),t&=!1):r.currentCheckBoxSendType().length>0&&ko.utils.arrayForEach(r.currentCheckBoxSendType(),function(n){n.giftCerSendTypeName()==cEmail&&r.currentEmail().length==0&&($(".modal-body .inputRecipient .email").addClass(cCssInputValidateError),t&=!1);n.giftCerSendTypeName()==cTextMessage&&r.currentPhone().length==0&&($(".modal-body .inputRecipient .phone").addClass(cCssInputValidateError),t&=!1)});r.currentFrom().length==0&&($(".modal-body .inputPurchaser input").addClass(cCssInputValidateError),t&=!1);r.currentMessage().length==0&&($(".modal-body .inputMessage textarea").addClass(cCssInputValidateError),t&=!1);r.currentGetAmount()==0&&r.currentPayAmount()==0&&r.currentIsCustomDiscount()&&($("#modalCartUpdate input.descCustomAmount").addClass(cCssInputValidateError),t&=!1);t&&(n=r.data()[r.currentCartId()-1],n.phone(r.currentPhone()),n.email(r.currentEmail()),n.from(r.currentFrom()),n.message(r.currentMessage()),n.selectDate(r.currentIsAsap()?_currentTime.toDate():r.currentSelectDate()),n.selectCheckBoxSendType(r.currentCheckBoxSendType()),n.todayAsap(r.currentIsAsap()?!0:!1),_.findIndex(r.currentCheckBoxSendType(),function(n){return n.giftCerSendTypeName()==cEmail})<0&&n.email(""),_.findIndex(r.currentCheckBoxSendType(),function(n){return n.giftCerSendTypeName()==cTextMessage})<0&&n.phone(""),updateItemStore(n.cartId(),n),$("#modalCartUpdate").modal("hide"),setStore("btnSaveUpdate",!0))};r.clickCheckOut=function(){r.clickBackCart();isDevice()=="mobile"&&vmViewIndex.mobile.showAccountSelect(!0);vmViewIndex.checkout.showLogIn(!0);vmViewIndex.checkout.showRegister(!1);vmViewIndex.checkout.showGuest(!1);vmViewIndex.checkout.step(1);vmViewIndex.showMain(!1);vmViewIndex.showCheckOut(!0);vmViewIndex.showMobile(!1);setScrollTop()};r.clickBackCart=function(){$("#modalCart").modal("hide");r.showPopupCart(!1)};r.isPayGoogle=ko.observable(!1);r.isPayApple=ko.observable(!1);r.applePayToken=ko.observable("");r.applePayEmergepayJson=ko.observable("");r.emergepayTransactionToken=ko.observable("");r.checkVisibleFieldCreditCard=function(n){return n?vmViewIndex.paymentServiceProvider()==cPaymentServiceProvider_Emergepay:vmViewIndex.paymentServiceProvider()==cPaymentServiceProvider_Usaepay}}function CheckOutViewModel(){var n=this;n.signIn=ko.observable(!1);n.showLogIn=ko.observable(!0);n.showRegister=ko.observable(!1);n.showGuest=ko.observable(!1);n.step=ko.observable(0);n.verifyCaptcha=ko.observable(!1);n.verifyCaptchaLogin=ko.observable(!1);n.clickLogIn=function(){$("#modalCaptchaRegister").modal({backdrop:!0,keyboard:!1,show:!1});$("#modalCaptchaGuest").modal({backdrop:!1,keyboard:!1,show:!1});$("#modalCaptchaLogin").modal({backdrop:!0,keyboard:!1,show:!0})};n.clickRegister=function(){$("#modalCaptchaLogin").modal({backdrop:"static",keyboard:!1,show:!1});$("#modalCaptchaGuest").modal({backdrop:"static",keyboard:!1,show:!1});$("#modalCaptchaRegister").modal({backdrop:"static",keyboard:!1,show:!0})};n.clickGuest=function(){$("#modalCaptchaLogin").modal({backdrop:"static",keyboard:!1,show:!1});$("#modalCaptchaRegister").modal({backdrop:"static",keyboard:!1,show:!1});$("#modalCaptchaGuest").modal({backdrop:"static",keyboard:!1,show:!0});n.showLogIn(!1);n.showRegister(!1);n.showGuest(!0)};$("#modalCaptchaGuest").on("hidden.bs.modal",function(){n.showLogIn(!1);n.showRegister(!1);n.showGuest(!1)});n.clickShowLogIn=function(){n.showLogIn(!0);n.showRegister(!1);n.showGuest(!1)};n.clickShowRegister=function(){n.showLogIn(!1);n.showRegister(!0);n.showGuest(!1)};n.clickShowGuest=function(){n.showLogIn(!1);n.showRegister(!1);n.showGuest(!0)};n.clickBackUser=function(){$(".descriptionPreview .amount").slick("slickGoTo",0);n.step(0);vmViewIndex.showMain(!0);vmViewIndex.showCheckOut(!1);setScrollTop()};n.clickNextUser=function(){if(vmViewIndex.mobile.logInSuccessed()||vmViewIndex.desktop.logInSuccessed()||vmViewIndex.guestLogin.guestId().length>0||vmViewIndex.customer.customerId().length>0)n.step(2),$("#checkout-order").find(".checkout").hide(),$("#checkout-user").removeClass("active"),$('a[href="#checkout-user"]').removeClass("active"),$("#checkout-order").addClass("active"),$('a[href="#checkout-order"]').addClass("active"),$(".cart-cardDetail").removeClass("none");else if(n.showGuest())if(vmViewIndex.guestLogin.guestId().length<=0&&vmViewIndex.customer.customerId().length<=0)addSpinButtonNextUser(),$("#"+cfrmGuestLogin).submit();else return;else swal(cSwal_Alert_Error,replaceNewLineToBr("Please sign in before click button."),cSwal_Icon_Error);setScrollTop()};n.clickBackOrder=function(){n.step(1);$("#checkout-order").removeClass("active");$('a[href="#checkout-order"]').removeClass("active");$("#checkout-user").addClass("active");$('a[href="#checkout-user"]').addClass("active");$(".cart-cardDetail").addClass("none");setScrollTop()};n.clickNextOrder=function(){setUpGooglePay();checkApplePay();checkSetUpEmergepayCheckout()||n.changeToPayment()};n.changeToPayment=function(){countdown(15,!1);vmViewIndex.checkout.step(3);$("#checkout-order").removeClass("active");$('a[href="#checkout-order"]').removeClass("active");$("#checkout-payment").addClass("active");$('a[href="#checkout-payment"]').addClass("active");setScrollTop()};n.clickBackPayment=function(){n.step(2);$("#checkout-order").addClass("active");$('a[href="#checkout-order"]').addClass("active");$("#checkout-payment").removeClass("active");$('a[href="#checkout-payment"]').removeClass("active");setScrollTop();window.clearTimeout(timeoutHandle)};n.clickNextPayment=function(){var r;if(vmViewIndex.cart.isPayGoogle(!1),vmViewIndex.cart.isPayApple(!1),vmViewIndex.cart.paymentType()==cPaybyCredit){var i=$(getIdTag(cfrmConfirmPayment)),u=i.attr("id"),f=i.parent(),t=new ObjValidateForm(u,f);if(t.verifyData(),t.error.length>0)return t.showAlert&&(r=convertArrToString(t.error),swal(cSwal_Alert_Error,replaceNewLineToBr(r),cSwal_Icon_Error)),!0;if(vmViewIndex.cart.invalidAddress().length>0)return suggestionAddress(vmViewIndex.cart.invalidAddress()),!0}vmViewIndex.globalConfig.captchaEnable()?vmViewIndex.checkout.verifyCaptcha()?n.checkSwalConfirmPayment():(swal("Oops...","Please check the box below to processed",cSwal_Icon_Info),resetCaptCha()):n.checkSwalConfirmPayment()};n.checkSwalConfirmPayment=function(){vmViewIndex.paymentServiceProvider()==cPaymentServiceProvider_Emergepay&&vmViewIndex.cart.paymentType()==cPaybyCredit?$(`#${cfrmConfirmPayment_Emergepay_PayBtn}`).click():swalConfirmPayment(cfrmConfirmPayment)};n.complete=function(){redirectMain()}}function verifyCaptcha(){vmViewIndex.checkout.verifyCaptcha(!0)}function verifyCaptchaLogin(){vmViewIndex.checkout.verifyCaptchaLogin(!0)}function ChangePasswordViewModel(){var n=this;n.oldPassword=ko.observable("");n.newPassword=ko.observable("");n.confirmPassword=ko.observable("")}function OrderHistoryViewModel(){var n=this;n.data=ko.observableArray([])}
$(document).on("click",".descCustomAmount",function(){$(this).select()});$(document).on("click",".descriptionPreview input",function(){$(this).removeClass(cCssInputValidateError)});$(document).on("click",".descriptionPreview textarea",function(){$(this).removeClass(cCssInputValidateError)});$(document).on("click",".modal-body input",function(){$(this).removeClass(cCssInputValidateError)});$(document).on("click",".modal-body textarea",function(){$(this).removeClass(cCssInputValidateError)});$(document).on("keydown",".descriptionPreview input",function(){$(this).removeClass(cCssInputValidateError)});$(document).on("keydown",".descriptionPreview textarea",function(){$(this).removeClass(cCssInputValidateError)});$(document).on("keydown",".modal-body input",function(){$(this).removeClass(cCssInputValidateError)});$(document).on("keydown",".modal-body textarea",function(){$(this).removeClass(cCssInputValidateError)});
$(".btnCart").click(function(){if(isDevice()!="desktop"){if(vmViewIndex.checkout.step()>1)return!0;vmViewIndex.giftCerDetail.clearInvalidateError();$("#modalCart").modal({keyboard:!1,backdrop:!0});$(".cart-header").hide();vmViewIndex.cart.showPopupCart(!0)}});$("#modalCart").on("hidden.bs.modal",function(){$(".panel-cart").is(":visible")&&$(".cart-header").show()});$("#modalCartUpdate").on("hidden.bs.modal",function(){$(".panel-cart").is(":visible")||($(".cart-header").hide(),$("#modalCart").modal({keyboard:!1,backdrop:!1}),vmViewIndex.cart.showPopupCart(!0))});
function setUpEmergepayCheckout(){function i(n){return new Promise(function(t,i){var r=new ObjUrl(cJsonGetEmergepayTransactionToken),u=r.getUrlFromJson(),f={transactionType:n};$.ajax({url:u,"async":ajax_async,cache:ajax_cache,type:ajax_type_post,data:f,timeout:ajax_timeout,headers:{RequestVerificationToken:token()}}).done(function(n){n.status?t(n.obj):(isLoading(!1),i("Error getting transaction token"))}).fail(function(n){isLoading(!1);i(n)})})}function r(n){return isEmpty(n)?"unknown":(n=n.trim().replaceAll("-","").toUpperCase(),n=="Mastercard".toUpperCase()?"mastercard":n=="DinersClub".toUpperCase()?"dinersclub":n=="Visa".toUpperCase()?"visa":n=="JCB".toUpperCase()?"jcb":n=="AmericanExpress".toUpperCase()||n=="amex".toUpperCase()?"amex":n=="Discover".toUpperCase()?"discover":"unknown")}isLoading(!0);$(`.${cfrmConfirmPayment_Emergepay_ValidationError}`).text("");var t=cEmergepay_TransactionType_CreditSale,n={display:"block",width:"100%",height:"calc(2.25rem + 2px)",padding:"0.375rem 0.75rem","font-size":"1rem","line-height":"1.5",color:"#495057","background-color":"#fff",border:"1px solid #ced4da","border-radius":"0.25rem",transition:"border-color .15s ease-in-out,box-shadow .15s ease-in-out"};i(t).then(function(i){vmViewIndex.cart.emergepayTransactionToken("");var u=emergepayFormFields.init({transactionToken:i,transactionType:t,fieldSetUp:{cardNumber:{appendToSelector:cfrmConfirmPayment_Emergepay_CardNumberContainer,useField:!0,autoIframeHeight:!0,styles:n},cardExpirationDate:{appendToSelector:cfrmConfirmPayment_Emergepay_ExpirationDateContainer,useField:!0,autoIframeHeight:!0,styles:n},cardSecurityCode:{appendToSelector:cfrmConfirmPayment_Emergepay_SecurityCodeContainer,useField:!0,autoIframeHeight:!0,styles:n},accountNumber:{appendToSelector:"accountNumberContainer",useField:!1,autoIframeHeight:!0,styles:{}},routingNumber:{appendToSelector:"routingNumberContainer",useField:!1,autoIframeHeight:!0,styles:{}},accountHolderName:{appendToSelector:"accountHolderNameContainer",useField:!1,autoIframeHeight:!0,styles:{}},totalAmount:{useField:!1},externalTranId:{useField:!1}},fieldErrorStyles:{border:"1px solid #f00","background-color":"#fee"},onFieldError:function(n){console.log(n);isLoading(!1);var t=`#emergepay_${n.fieldId}_error`,i=n.result;$(t).text(i)},onFieldErrorCleared:function(n){console.log(n);isLoading(!1);var t=`#emergepay_${n.fieldId}_error`;$(t).text("")},onFieldsLoaded:function(){console.log("All fields loaded");isLoading(!1);vmViewIndex.checkout.step()!=3&&vmViewIndex.checkout.changeToPayment()},onUserAuthorized:function(n){console.log("transactionToken",n);isLoading(!1);vmViewIndex.cart.emergepayTransactionToken(n);swalConfirmPayment(cfrmConfirmPayment);countdownSwalConfirmPayment(5)},onBinChange:function(n){console.log("bin",n.bin);console.log("card type",n.cardType);var i=r(n.cardType),t=".jp-card";$(t).removeClass().addClass("jp-card");$(t).addClass("jp-card-"+i);$(t).toggleClass("jp-card-identified",i!=="unknown")}});$(`#${cfrmConfirmPayment_Emergepay_PayBtn}`).unbind().on("click",function(){isLoading(!0);u.process();setTimeout(function(){isEmpty(vmViewIndex.cart.emergepayTransactionToken())&&isLoading(!1)},4e3)})})}function checkSetUpEmergepayCheckout(){return vmViewIndex.paymentServiceProvider()==cPaymentServiceProvider_Emergepay&&vmViewIndex.cart.paymentType()==cPaybyCredit?(setUpEmergepayCheckout(),!0):(vmViewIndex.cart.emergepayTransactionToken(""),!1)}$("#txtCCNumber").on("keyup",function(n){var t=n.target.value.replace(" ",""),i=Payment.fns.cardType(t);vmViewIndex.cart.ccType(i)});$(document).on("click",cfrmConfirmPayment_Number,function(){disableErrMsgConfirmPayment($(this))});$(document).on("click",cfrmConfirmPayment_Name,function(){disableErrMsgConfirmPayment($(this))});$(document).on("click",cfrmConfirmPayment_Expiry,function(){disableErrMsgConfirmPayment($(this))});$(document).on("click",cfrmConfirmPayment_CCVC,function(){disableErrMsgConfirmPayment($(this))});$(document).on("click",cfrmConfirmPayment_BillingZip,function(){disableErrMsgConfirmPayment($(this))});$(document).on("click",cfrmConfirmPayment_BillingAddress,function(){disableErrMsgConfirmPayment($(this))});$(cfrmConfirmPayment_SuggestionAddressContent).on("click",".suggestionAddress",function(){var n=$(this).html(),t=$(this).attr("id");getGeoData(t,function(t){var f=t.postal_code==null?"":t.postal_code,e=t.lat==null?"":t.lat,o=t.lng==null?"":t.lng,r="",i="",u="";t.administrative_area_level_1_short!==null&&t.administrative_area_level_1_short!==""&&typeof t.administrative_area_level_1_short!="undefined"?r=t.administrative_area_level_1_short:t.administrative_area_level_2_short!==null&&t.administrative_area_level_2_short!==""&&typeof t.administrative_area_level_2_short!="undefined"&&(r=administrative_area_level_2_short);t.locality!==null&&t.locality!==""&&typeof t.locality!="undefined"?i=t.locality:t.sublocality!=null&&t.sublocality!=""&&typeof t.sublocality!="undefined"?i=t.sublocality:t.sublocality_level_1!=null&&t.sublocality_level_1!=""&&typeof t.sublocality_level_1!="undefined"&&(i=t.sublocality_level_1);t.sublocality!=null&&t.sublocality!=""&&typeof t.sublocality!="undefined"&&(u=t.sublocality);vmViewIndex.cart.ccBillingAddress(n);vmViewIndex.cart.ccBillingZip(f);vmViewIndex.cart.billingAddressLatitude(e);vmViewIndex.cart.billingAddressLongitude(o);vmViewIndex.cart.billingAddressCity(i);vmViewIndex.cart.billingAddressSubCity(u);vmViewIndex.cart.billingAddressState(r)});$(cfrmConfirmPayment_SuggestionAddress).modal("hide")});
$(document).on("click",cfrmGuestFirstName+", "+cfrmGuestLastName+", "+cfrmGuestEmail+", "+cfrmGuestPhone,function(){disableErrMsg($(this))});$(document).on("keydown",cfrmGuestFirstName+", "+cfrmGuestLastName+", "+cfrmGuestEmail+", "+cfrmGuestPhone,function(){disableErrMsg($(this))});
$(".popover-login").popover({trigger:"click",html:!0,title:function(){return $(this).parent().find(".popover-login-title-show").html()},content:function(){return $(this).parent().find(".popover-login-body-show").html()},container:"body",placement:"bottom",animation:!1});$(document).on("click","#modalCaptchaLogin .register",function(){$("#modalCaptchaLogin").modal("hide");$("#modalCaptchaRegister").modal({backdrop:!1,keyboard:!1,show:!0})});$(document).on("click",cfrmLogIn_Email,function(){disableErrMsg($(this))});$(document).on("click",cfrmLogIn_Password,function(){disableErrMsg($(this))});$(document).on("click",".linkRegister",function(){$(".popover-login").popover("hide");$(".popover-register").popover("show")});$(document).on("click",".linkForgotPassword",function(){$(".popover-login").popover("hide");$(".popover-register").popover("hide")});
$(".popover-register").popover({trigger:"click",html:!0,title:function(){return $(this).parent().find(".popover-register-title-show").html()},content:function(){return $(this).parent().find(".popover-register-body-show").html()},container:"body",placement:"bottom",animation:!1});$(document).on("click",cfrmRegister_Email+" , "+cfrmRegister_FirstName+" , "+cfrmRegister_LastName+" , "+cfrmRegister_Password+" , "+cfrmRegister_ConfirmPassword,function(){disableErrMsg($(this))});

function Mobile(){function t(t){t.showMobile(!0);t.showMenu(!1);n.showLogIn(!1);n.showRegister(!1);n.showProfile(!1);n.showChangePassword(!1);n.showHistory(!1)}var n=this;n.showLogIn=ko.observable(!1);n.showRegister=ko.observable(!1);n.showProfile=ko.observable(!1);n.showChangePassword=ko.observable(!1);n.showHistory=ko.observable(!1);n.logInSuccessed=ko.observable(!1);n.showAccountSelect=ko.observable(!0);n.clickMenu=function(i,r){var u=r.target.innerText.trim();t(i);switch(u){case cMobileMenuHome:i.showMobile(!1);i.showCheckOut(!1);i.showMain(!0);n.showHistory(!1);break;case cMobileMenuLogIn:n.showLogIn(!0);i.showCheckOut(!1);i.showMain(!1);n.showHistory(!1);n.showAccountSelect(!1);break;case cMobileMenuRegister:n.showRegister(!0);i.showCheckOut(!1);i.showMain(!1);n.showHistory(!1);n.showAccountSelect(!1);break;case cMobileMenuProfile:n.showProfile(!0);i.showCheckOut(!1);i.showMain(!1);n.showHistory(!1);break;case cMobileMenuChangePassword:n.showChangePassword(!0);i.showCheckOut(!1);i.showMain(!1);n.showHistory(!1);break;case cMobileMenuHistory:n.showHistory(!0);n.showChangePassword(!1);i.showCheckOut(!1);i.showMain(!1);break;case cMobileMenuLogOff:i.showMobile(!1);i.showCheckOut(!1);i.showMain(!1);getIdTag(cfrmLogOff).submit();break;default:i.showMobile(!1);i.showCheckOut(!1);i.showMain(!0)}setScrollTop();$(".ssm-toggle-nav")[0].click()}}
function DeskTop(){self=this;self.customerName=ko.observable("");self.logInSuccessed=ko.observable(!1)}
$(document).ready(function(){$("body").addClass("loaded");$("#btnBackToHome").click(function(){var n=$("#divHomeViewIndex").data("request-url");location.href=n})});
$(document).ready(function(){function e(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){try{var p=this;p.showTermsAndCondition=ko.observable(!1);p.showPrivacyProlicy=ko.observable(!1);window.location.hash.includes("TermsAndConditions")?(p.showTermsAndCondition(!0),$("#termsAndCondition").show(),$("#privacyProlicy").hide(),$("#koMenuView").hide(),$("body").removeClass("loading")):window.location.hash.includes("PrivacyPolicy")?(p.showPrivacyProlicy(!0),$("#privacyProlicy").show(),$("#termsAndCondition").hide(),$("#koMenuView").hide(),$("body").removeClass("loading")):($("#koMenuView").show(),$("#privacyProlicy").hide(),$("#termsAndCondition").hide(),p.showMobile=ko.observable(!1),p.showMenu=ko.observable(!0),p.showMain=ko.observable(!0),p.showCheckOut=ko.observable(!1),p.disableBtnSubmit=ko.observable(!1),p.apiKey=ko.observable(l),p.apiKeyEmergepay=ko.observable(a),p.paymentServiceProvider=ko.observable(parseInt(y)),p.currentDatetime=ko.observable(n),p.currentDay=ko.observable(t),p.logInFb=isEmpty(i)?ko.observable(!1):ko.observable(!0),p.loading=new LoadingViewModel,p.customer=new CustomerViewModel(u),p.changePassword=new ChangePasswordViewModel,p.globalConfig=new GlobalConfigViewModel(r),p.giftCerImages=new GiftCerImagesViewModel(f,e,o),p.giftCerAmount=new GiftCerAmountViewModel(s),p.giftCerCustomDiscount=new GiftCerCustomDiscount(h),p.giftCerDetail=new GiftCerDetailViewModel(c,n),p.guestLogin=new GuestViewModel,p.cart=new CartViewModel(c,n,v),p.checkout=new CheckOutViewModel,p.orderHistory=new OrderHistoryViewModel,p.mobile=new Mobile,p.desktop=new DeskTop,isEmpty(u)||(p.desktop.logInSuccessed(!0),p.mobile.logInSuccessed(!0)))}catch(w){logErrorJavaScript(w,"home-index.js/viewModel",123,!0)}}function n(n,t){var i=new ObjUrl(n),r=i.getUrlFromJson(),u=JSON.parse('{"key" : "'+t+'"}');return getJsonFromAjaxAddHeader(r,!ajax_async,ajax_cache,ajax_type_post,u,ajax_timeout,token())}var t,f,h,tt,it,rt;if(window.onerror=function(n,t,i){return t.indexOf("inject.js")!=-1&&logErrorJavaScript(n,t,i,!1),!0},t="?2023041901",window.location.search!==t)if(window.location.search.includes("email")){if(!window.location.search.includes(t)){var u=window.location.search,ut=u.indexOf("?"),ft=u.substring(ut+1,u.length),f=window.location.protocol+"//"+window.location.host+"/"+window.location.pathname+t+"&"+ft;window.history.pushState({},"",f)}}else{if(window.location.hash.includes("PrivacyPolicy")||window.location.hash.includes("TermsAndConditions"))return!1;f=window.location.protocol+"//"+window.location.host+"/"+window.location.pathname+t;window.history.pushState({},"",f)}if(window.location.hash.includes("TermsAndConditions")||window.location.hash.includes("PrivacyPolicy"))vmViewIndex=new e;else{var i=JSON.parse(n(cJsonGetDateTime,"")),o=$("#divVarAuthenticated").val(),c=$("#divVarLogInType").val(),et=$("#divVarCustomerKey").val(),s="",r="";s=i.currentDay.length==0?$("#divVarCurrentDay").val():i.currentDay;r=i.currentDateTime.length==0?$("#divVarCurrentDateTime").val():i.currentDateTime;var ot=convertStrToBool($("#divVarShowResetPasswordForm").val()),st=convertStrToBool($("#divVarConfirmAccount").val()),ht=convertStrToBool($("#divVarDeleteAccount").val()),l=$("#divVarConfirmToken").val(),a=$("#divModelGlobalConfig").val(),v=$("#divModelGiftCerImagesMobile").val(),y=$("#divModelGiftCerImagesTablet").val(),p=$("#divModelGiftCerImagesDesktop").val(),w=$("#divModelGiftCerValue").val(),b=$("#divModelGiftCerCustomDiscount").val(),k=$("#divModelGiftCerSendType").val(),d=$("#divApiKey").val(),g=$("#divApiKeyEmergepay").val(),nt=$("#divVarPaymentServiceProvider").val(),ct=$("#divErrorServerMaintenance").data("request-url");isEmpty(o)?vmViewIndex=new e(r,s,c,a,null,v,y,p,w,b,k,d,g,null,nt):(h=n(cJsonGetHeaderToken),h!=null&&(tt=JSON.parse(h),$("#divVarHeader").val(tt)),it=n(cJsonGetCustomer,et),rt=n(cJsonGetCustomerAddressBilling,o),vmViewIndex=new e(r,s,c,a,it,v,y,p,w,b,k,d,g,rt,nt))}if(!vmViewIndex.showTermsAndCondition()&&!vmViewIndex.showPrivacyProlicy()){_currentTime=moment(r,moment_date_format_mmddyyyyhhmmssa);setInterval(function(){f()},6e4);koBindingHandlers();ko.applyBindings(vmViewIndex,document.getElementById("koMenuView"));refreshStore();isEmpty(o)||i(vmViewIndex.customer.customerId(),!1);$("nav.nav-mobile").slideAndSwipe();$("#frmConfirmPayment").card({container:".card-wrapper",messages:{validDate:"expire\ndate",monthYear:"mm/yyyy"},width:200,placeholders:{number:"•••• •••• •••• ••••",name:"Full Name",expiry:"••/••••",cvc:"•••"},masks:{cardNumber:"•"}});setBlockEmoji();setInputCustomAmountNumeric();checkDisableCheckboxDelivery();setGeoLocation();$(document).on("submit","form",function(){var r,f,i;if(!checkInternetConnection())return r=new ObjAlert(n,cError_Fail_NoInternet,!1),r.getAlert(),!1;var o=$(this),n=o.attr("id"),s=$(this).parent(),t=new ObjValidateForm(n,s);if(t.verifyData(),t.error.length>0)return t.showAlert&&(f=convertArrToString(t.error),swal(cSwal_Alert_Error,replaceNewLineToBr(f),cSwal_Icon_Error)),!1;addSpinButton(n);vmViewIndex.disableBtnSubmit(!0);var h=$(this).serialize(),c=new ObjUrl(n),e=c.getUrlSubmitForm();return isEmpty(e)?(swal(cSwal_Alert_Error,cError_Dev_Url,cSwal_Icon_Error),!1):(i=$.ajax({url:e,"async":ajax_async,cache:ajax_cache,type:ajax_type_post,data:h,timeout:ajax_timeout,headers:{RequestVerificationToken:token()}}),i.done(function(i){var r;i.status&&u(n,i);t.showAlert&&(n==cfrmConfirmPayment||n==cfrmDiscount?i.status||(i.obj=="redirect"?swal("",i.message,cSwal_Icon_Error).then(function(){redirectMain()},function(){}):(r=new ObjAlert(n,i.message,i.status),r.getAlert())):(vmViewIndex.globalConfig.captchaEnable()&&n==cfrmRegister&&resetCaptCha(),r=new ObjAlert(n,i.message,i.status),r.getAlert()));vmViewIndex.disableBtnSubmit(!1);removeSpinButtonNextUser();removeSpinButton(n)}),i.fail(function(){vmViewIndex.disableBtnSubmit(!1);removeSpinButtonNextUser();removeSpinButton(n);var t=new ObjAlert(n,cError_Fail_TimeOut,!1);t.getAlert()}),!1)});function u(t,r){var o,u,f,e;switch(t){case cfrmLogIn:case cfrmRegister:try{f=n(cJsonGetHeaderToken);f!=null&&(e=JSON.parse(f),$("#divVarHeader").val(e));const s=$("#modalCaptchaLogin").is(":visible");s&&$("#modalCaptchaLogin").modal("hide");const h=$("#modalCaptchaRegister").is(":visible");h&&$("#modalCaptchaRegister").modal("hide");ko.mapping.fromJSON(r.obj,{},vmViewIndex.customer);i(vmViewIndex.customer.customerId(),!0);vmViewIndex.customer.profileUpdate.firstName(vmViewIndex.customer.firstName());vmViewIndex.customer.profileUpdate.lastName(vmViewIndex.customer.lastName());vmViewIndex.customer.profileUpdate.ownerPhone(vmViewIndex.customer.ownerPhone());o=n(cJsonGetCustomerAddressBilling,vmViewIndex.customer.customerId());isEmpty(o)||o=="null"||(u=new CustomerAddressBillingCurrentViewModel(JSON.stringify(JSON.parse(o))),vmViewIndex.cart.ccBillingAddress(u.address()),vmViewIndex.cart.billingAddressLatitude(u.latitude()),vmViewIndex.cart.billingAddressLongitude(u.longitude()),vmViewIndex.cart.billingAddressCity(u.city()),vmViewIndex.cart.billingAddressSubCity(""),vmViewIndex.cart.billingAddressState(u.state()),vmViewIndex.cart.ccBillingZip(u.postTal()));vmViewIndex.desktop.logInSuccessed(!0);vmViewIndex.mobile.logInSuccessed(!0);vmViewIndex.checkout.step()==0?(vmViewIndex.showMobile(!1),vmViewIndex.showMain(!0),vmViewIndex.showCheckOut(!1)):(vmViewIndex.showMobile(!1),vmViewIndex.showMain(!1),vmViewIndex.showCheckOut(!0),setGeoLocation());t==cfrmLogIn?$(".popover-login").popover("hide"):$(".popover-register").popover("hide");checkAuthenticationExpiration()}catch(s){logErrorJavaScript(s,"home-index.js/cfrmRegister",417,!0)}break;case cfrmLogOff:location.replace(r.url);break;case cfrmForgotPassword:$("#modalForgotPassword").modal("hide");break;case cfrmResetPassword:$("#modalResetPassword").modal("hide");break;case cfrmCustomerProfileUpdate:vmViewIndex.customer.firstName(vmViewIndex.customer.profileUpdate.firstName());vmViewIndex.customer.lastName(vmViewIndex.customer.profileUpdate.lastName());vmViewIndex.customer.ownerPhone(vmViewIndex.customer.profileUpdate.ownerPhone());break;case cfrmChangePassword:vmViewIndex.changePassword.oldPassword("");vmViewIndex.changePassword.newPassword("");vmViewIndex.changePassword.confirmPassword("");break;case cfrmLogOff:location.replace(r.url);break;case cfrmGuestLogin:f=n(cJsonGetHeaderToken);f!=null&&(e=JSON.parse(f),$("#divVarHeader").val(e));const h=$("#modalCaptchaGuest").is(":visible");h&&$("#modalCaptchaGuest").modal("hide");ko.mapping.fromJSON(r.obj,{},vmViewIndex.guestLogin);vmViewIndex.guestLogin.guestId().length>0&&vmViewIndex.checkout.clickNextUser()}}$("html").on("mouseup",function(n){$(n.target).closest(".popover").length||$(n.target).attr("id")=="btnCheckOut"||$(n.target).text()=="Check Out"||$(n.target).text()=="OK"||$(".popover").each(function(){$("[data-original-title]").popover("hide");$(".popover-login").blur()})});$(window).resize(function(n){isTouchDevice()||($(n.target).closest(".popover").length||$(n.target).attr("id")=="btnCheckOut"||$(n.target).text()=="Check Out"||$(n.target).text()=="OK"||$(".popover").each(function(){$("[data-original-title]").popover("hide");$(".popover-login").blur()}),t())});t();$(window).scroll(function(){var i=$(window).scrollTop(),r=isDevice(),e=r=="mobile"||r=="phablet",f;if(e)$(".panel-cart").stop().animate({top:0});else{var n=$(window).outerHeight(!0),o=$(".panel-cart").offset(),t=$(".panel-cart").outerHeight(!0),s=t+o.top-90,u=$(".footer").outerHeight(!0);(t>=n||s>n-u)&&(f=t-n+u+100,$(".panel-cart").stop().animate({top:-f}));i<100&&$(".panel-cart").stop().animate({top:90})}i>300?($(".backToTop").addClass("show"),$(".footer-nav").removeClass("d-none")):($(".backToTop").removeClass("show"),$(".footer-nav").addClass("d-none"))});$(".cardPreview .header .character").hide();$(".cardDetail .mobile .preview").hide();setTimeout(function(){$("body").removeClass("loading");$("body").addClass("loaded");$(".viewLoading").removeClass("gb_hidden");$(".amount.slick-slider").slick("setPosition");ot&&($("#modalResetPassword").modal({backdrop:"static",keyboard:!1}),$("#modalResetPassword").modal("hide"),$("#modalResetPassword").modal("show"));st?(vmViewIndex.loading.loadingVisible(!0),callBackAccountConfirm(l,!0)):ht&&(vmViewIndex.loading.loadingVisible(!0),callBackAccountConfirm(l,!1));var n=checkVersionIE();isEmpty(n)||n<11&&$("#browserVerionModel").modal("show");$(".cardPreview .header .character").show();$(".cardPreview .header .character span").addClass("keyframe");$(".cardPreview .mobile .preview").addClass("animated fadeInUp");$(".cardPreview .tablet .border-slice-horizontal").addClass("border-transition");checkAuthenticationExpiration()},0);function f(){_currentTime.add(1,moment_minute)}function t(){var n=$(window).width();n>=576?$(".jp-card-container").css({transform:"scale(0.9)"}):$(".jp-card-container").css({transform:"scale(0.5)"})}function i(t){var r=n(cJsonGetOrderHistory,t),i;r.length>0&&(i=JSON.parse(r),isEmpty(i.result)||(ko.utils.arrayForEach(i.result.giftCerDataRaw,function(n){var t=ko.utils.arrayFilter(i.result.giftCerOrders,function(t){return t.giftCode==n.giftCode}),r=ko.utils.arrayFilter(i.result.giftCerImages,function(n){return n.giftCerImagesId==_.first(t).giftCerImagesId});vmViewIndex.orderHistory.data.push(new DataOrderHistoryModel(n,_.first(t),_.first(r)))}),ko.cleanNode(document.getElementById($("#modalHistory").attr("id"))),ko.applyBindings(vmViewIndex,document.getElementById($("#modalHistory").attr("id"))),ko.utils.arrayForEach(i.result.giftCerOrders,function(n){$("#item-barcode"+n.giftCode).barcode(n.giftCode,"code128");$("#item-barcode-mobile"+n.giftCode).barcode(n.giftCode,"code128")})))}giftCardDetail();eventModal()}});
//# sourceMappingURL=maps/project-bundle.min.js.map
